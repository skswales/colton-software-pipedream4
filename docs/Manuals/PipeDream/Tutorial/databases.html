<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="content-type" content="text/html; charset=iso-8859-1" />
  <title>Databases</title>
  <meta name="generator" content="Amaya, see http://www.w3.org/Amaya/" />
  <link href="csguide.css" rel="stylesheet" type="text/css" />
</head>

<body>
<!-- This Source Code Form is subject to the terms of the Mozilla Public
   - License, v. 2.0. If a copy of the MPL was not distributed with this
   - file, You can obtain one at http://mozilla.org/MPL/2.0/. -->
<!-- Copyright (C) 1991-1998 Colton Software Limited
   - Copyright (C) 1998-2015 R W Colton -->
<div class="navheader">
<table width="100%" summary="Navigation header">
<tr>
<td width="20%" align="left"><a accesskey="p" href="spreadsheets.html">Prev</a> </td>
<th width="60%" align="center">PipeDream Tutorial</th>
<td width="20%" align="right"> <a accesskey="n" href="combineddocuments.html">Next</a></td>
</tr>
</table>
<hr/>
</div>

<h1>Databases</h1>

<p>PipeDream enables you to store a database of records and provides
facilities to sort your records on one or more fields. You can save and
print out those records which satisfy one or more conditions which
you specify. PipeDream also provides several database functions
which enable you to produce statistics about your records.</p>

<p>The best way to become familiar with using PipeDream as a database
is to load a database of records and try out the various facilities upon
it. An example is a pupil records database called Markbook, which is
provided in the Examples archive, in the directory called Tutorial.</p>

<h2>Loading the Example (Markbook) Database</h2>

<p>To load the example database:</p>
<ol>
  <li>Download the PipeDream Examples archive onto your disc drive.</li>
  <li>Make a writable copy of the contents of the archive on your disc drive.
Open the Examples archive with SparkFS, then simply drag the contents of the
Example archive to a different location on your disc drive. Close the Examples
archive directory viewer to avoid confusion!</li>
  <li>Double-click Select on the Tutorial directory's icon.</li>
  <li>Double-click Select on the icon of the file called 'Markbook' to
load it into PipeDream.</li>
  <li>When the file has been loaded into PipeDream, use the toggle size
icon if you need to change the size of the window.</li>
</ol>

<p>The database consists of a list of pupils together with their classes,
subjects (one of history or physics, indicated by H or P), continuous
assessment marks, examination marks and total marks. Each record
is stored on one row and each field is in a separate column.</p>

<p>If you scroll down through the database, you will find that the column
headings, which let you know which field is in each column, disappear
from the top of the window.</p>

<h2>Fixing Rows</h2>

<p>It is possible to fix rows so that the column headings always remain at
the top of the window. To do so:</p>

<ol>
  <li>Position the caret on row two.</li>
  <li>Give the <span class="csguide-command">Fix Row</span> command:</li>
</ol>

<table class="csguide-command-table">
  <col />
  <col />
  <col />
  <col />
  <tbody>
    <tr>
      <th class="csgcth-menu">Menu</th>
      <th class="csgcth-command">Command</th>
      <th class="csgcth-ctrl">Ctrl-sequence</th>
      <th class="csgcth-key">Key</th>
    </tr>
    <tr>
      <td>Layout</td>
      <td>Fix row</td>
      <td><span class="csguide-key">LAF</span></td>
      <td></td>
    </tr>
  </tbody>
</table>

<p>The borders of rows one and two change colour to show that the
rows are fixed.</p>

<p>Try scrolling down through the database. You will see that rows one
and two remain at the top of the window.</p>

<h2>Sorting the Database</h2>

<p>When you first load the database it is sorted on column C, i.e. on class.
You will see that all the pupils in 1A are first, followed by those in 1B,
then 2A, then 2B.</p>

<p>If you would rather have the pupils listed in alphabetical order of
surname, you need to sort the database on column B, the column
containing the surnames.</p>

<p>To sort on column B:</p>
<ol>
  <li>Mark the block of records you want to sort by dragging Select
    down the borders of rows 3 to 39. Dragging Select down the row
    border marks all of the columns in these rows.</li>
</ol>

<p>Note that dragging Select beyond the bottom of the window has the
effect of scrolling downwards so that you can see and mark data
which was not visible at first.</p>

<ol start="2">
  <li>Give the <span class="csguide-command">Sort</span> command:</li>
</ol>

<table class="csguide-command-table">
  <col />
  <col />
  <col />
  <col />
  <tbody>
    <tr>
      <th class="csgcth-menu">Menu</th>
      <th class="csgcth-command">Command</th>
      <th class="csgcth-ctrl">Ctrl-sequence</th>
      <th class="csgcth-key">Key</th>
    </tr>
    <tr>
      <td>Blocks</td>
      <td>Sort</td>
      <td><span class="csguide-key">BSO</span></td>
      <td></td>
    </tr>
  </tbody>
</table>

<ol start="3">
  <li>When the <span class="csguide-dbox">Sort</span> dialogue box appears,
    delete <span class="csguide-key">A</span> with the
    <span class="csguide-key">Backspace</span> key and type
    <span class="csguide-key">B</span> since this is the column you want to sort on.</li>
  <li>Click the <span class="csguide-dbox-button">OK</span> button or
    press <span class="csguide-key">Enter</span>.</li>
  <li>Click Select on the mark block box to clear the marked block.
    The records will be sorted in alphabetical order of surname.</li>
</ol>

<p>PipeDream also enables you to sort on more than one column at once.</p>

<p>If you want to list pupils in classes 1A, 1B, 2A and 2B in order of the
total marks they gained in history and physics, you need to sort first
on column C, which contains the classes, then on column D, which
contains the the subjects, and finally on column G, the one containing
the total marks.</p>

<p>Mark rows 3 to 39 by dragging Select down the row borders.</p>

<p>Give the <span class="csguide-command">Sort</span> command.</p>

<p>Type <span class="csguide-key">C</span> on the first row of the dialogue box,
<span class="csguide-key">D</span> on the second row and
<span class="csguide-key">G</span> on the third row.
To move through the dialogue box, press or or click Select in the field you want.</p>

<p>Click the <span class="csguide-dbox-button">OK</span> button or press <span class="csguide-key">Enter</span>.</p>

<p>The records are now arranged in order of class, then subject, then
total mark, enabling you to see who was first in history in class 1A,
who was bottom in physics in class 2A, and so on.</p>

<p>Click Select in the mark block box to clear the marked block.</p>

<h2>Searching for Records</h2>

<p>If you want to find a particular pupil's record quickly, you can use
Search to find him or her.</p>

<p>Give the <span class="csguide-command">Search</span> command:</p>

<table class="csguide-command-table">
  <col />
  <col />
  <col />
  <col />
  <tbody>
    <tr>
      <th class="csgcth-menu">Menu</th>
      <th class="csgcth-command">Command</th>
      <th class="csgcth-ctrl">Ctrl-sequence</th>
      <th class="csgcth-key">Key</th>
    </tr>
    <tr>
      <td>Blocks</td>
      <td>Search</td>
      <td><span class="csguide-key">BSE</span></td>
      <td><span class="csguide-key">F4</span></td>
    </tr>
  </tbody>
</table>

<p>When the <span class="csguide-dbox">Search</span> dialogue box appears,
type in the name you want to find.</p>

<p>Try typing <span class="csguide-key">Quinn</span>.</p>

<p>Click the <span class="csguide-dbox-button">OK</span> button
or press <span class="csguide-key">Enter</span>.</p>

<p>The caret will be positioned next to the name Quinn.</p>

<p>If you want to find all pupils called John, give the
<span class="csguide-command">Search</span> command again.</p>

<p>When the <span class="csguide-dbox">Search</span> dialogue box appears,
delete <span class="csguide-key">Quinn</span> and type <span class="csguide-key">John</span>.</p>

<p>Click the <span class="csguide-dbox-button">OK</span> button
or press <span class="csguide-key">Enter</span>.</p>

<p>The caret will be positioned next to the first occurrence of the word
John.</p>

<p>To find the next occurrence of the word, give the
<span class="csguide-command">Next Match</span> command:</p>

<table class="csguide-command-table">
  <col />
  <col />
  <col />
  <col />
  <tbody>
    <tr>
      <th class="csgcth-menu">Menu</th>
      <th class="csgcth-command">Command</th>
      <th class="csgcth-ctrl">Ctrl-sequence</th>
      <th class="csgcth-key">Key</th>
    </tr>
    <tr>
      <td>Blocks</td>
      <td>Next match</td>
      <td><span class="csguide-key">BNM</span></td>
      <td><span class="csguide-key">F6</span></td>
    </tr>
  </tbody>
</table>

<p>Searching can be especially helpful if you have a very large database.</p>

<h2>Selecting Records</h2>

<p>One of the most useful aspects of database use is the ability to save
and print records which satisfy certain conditions.</p>

<p>If you need to predict your pupils' GCSE results, for example, you
might want to know which pupils in class 1A who study history got a
total mark higher than 100.</p>

<p>Or you might want to know which pupils got either a continuous
assessment mark lower than 50 or an examination mark lower than
45 so that you can give them extra attention next term.</p>

<p>To find out which pupils in class 1A who study history got a total mark
higher than 100:</p>

<ol>
  <li>If necessary, shrink the window a little so that you can see the
    PipeDream icon on the icon bar.</li>
  <li>Give the <span class="csguide-command">Save</span> command.</li>
  <li>When the <span class="csguide-dbox">Save</span> dialogue box appears,
    click Select on the <span class="csguide-option">Save selection of rows</span> option.</li>
  <li>Click Select to position the caret in the box to the right of the
    <span class="csguide-option">Save selection of rows</span> option.</li>
  <li>Type the following:</li>
</ol>

<p style="margin-left:2em;"><code>C1C39=&quot;1A&quot; &amp; D1D39=&quot;H&quot; &amp; G1G39&gt;100</code></p>

<p>The condition is too long to be completely visible in the dialogue box,
so the field will scroll as you type.</p>

<p>It tells PipeDream to save all those rows which have 1A in column C,
H in column D and a number higher than 100 in column G.</p>

<p>The cell references you have typed, C1, D1 and G1, will be updated
automatically for each new line in the database, changing to C2, D2
and G2, then C3, D3 and G3, and so on.</p>

<p>Notice that any text included in your condition must be enclosed
within double quotation marks, for example "1A".</p>
 
<p>The &amp; sign is used to link conditions when there are more than one.</p>

<p>The conditions on both sides of the &amp; sign must be true for the record
to be selected.</p>

<ol start="6">
  <li>Drag the PipeDream icon from the <span class="csguide-dbox">Save</span>
    dialogue box onto the PipeDream icon on the icon bar.</li>
</ol>

<p>A new PipeDream window will appear on the screen containing the
records you selected, i.e. a list of all pupils in class 1A who study history
and got a total mark higher than 100.</p>

<p>You can now save the new file or print it out, depending upon your
requirements.</p>

<p>To find out which pupils got a continuous assessment mark lower
than 50 or an examination mark lower than 45:</p>

<ol>
  <li>With the pointer in the example database window, give the
    <span class="csguide-command">Save</span> command.</li>
  <li>When the <span class="csguide-dbox">Save</span> dialogue box appears,
    click Select on the <span class="csguide-option">Save selection of rows</span> option.</li>
  <li>Delete any contents using the <span class="csguide-dbox">Backspace</span>
    key and type the following:</li>
</ol>

<p style="margin-left:2em;"><code>E1E39&lt;50 | F1F39&lt;45</code></p>

<p>To type <span class="csguide-key">|</span>, hold down
<span class="csguide-key">Shift</span> and press the
<span class="csguide-key">\</span> (backslash) key,
which is usually either just above the <span class="csguide-key">Enter</span>
key or to the left of the <span class="csguide-key">Z</span> key on UK 
PC-style keyboards.</p>

<p>This tells PipeDream to save all those rows which have either a
number lower than 50 in column E or a number lower than 45 in
column F.</p>

<p><span class="csguide-key">|</span> is used to represent 'or'.
Only one of the conditions needs to be true for the record to be selected.</p>

<ol start="4">
  <li>Drag the PipeDream file icon from the <span class="csguide-dbox">Save</span>
    dialogue box onto the PipeDream icon on the icon bar.</li>
</ol>

<p>A new PipeDream window will appear on the screen containing the
records you selected, i.e. a list of all pupils who either got an
assessment mark lower than 50 or an exam mark lower than 45.</p>

<p>Once again, you can save the new file or print it out, depending upon
your requirements.</p>

<h2>Entering Records</h2>

<p>You can type new records into PipeDream in the same way as you
type text. Type each record on a separate row and each field of the
record into a separate column.</p>

<p>Try entering a few new records into the Markbook database.
Position the caret in cell A15, for example.</p>

<p>Give the <span class="csguide-command">Insert Row</span> command:</p>

<table class="csguide-command-table">
  <col />
  <col />
  <col />
  <col />
  <tbody>
    <tr>
      <th class="csgcth-menu">Menu</th>
      <th class="csgcth-command">Command</th>
      <th class="csgcth-ctrl">Ctrl-sequence</th>
      <th class="csgcth-key">Key</th>
    </tr>
    <tr>
      <td>Edit</td>
      <td>Insert row</td>
      <td><span class="csguide-key">N</span></td>
      <td><span class="csguide-key">F7</span></td>
    </tr>
  </tbody>
</table>

<p>Type in the first name of a pupil. Press . You are now in column B,
ready to type in the pupil's surname. When you have done so, press
again to move to column C, where you can type in the pupil's
class. Continue in this way until the pupil's record is complete.</p>

<p>Try adding more pupil records to the database.</p>

<h2>Deleting Records</h2>

<p>If a pupil leaves the school, you will want to remove his or her record
from the database.</p>

<p>Position the caret on the row you want to delete.
Give the <span class="csguide-command">Delete Row</span> command:</p>

<table class="csguide-command-table">
  <col />
  <col />
  <col />
  <col />
  <tbody>
    <tr>
      <th class="csgcth-menu">Menu</th>
      <th class="csgcth-command">Command</th>
      <th class="csgcth-ctrl">Ctrl-sequence</th>
      <th class="csgcth-key">Key</th>
    </tr>
    <tr>
      <td>Edit</td>
      <td>Delete row</td>
      <td><span class="csguide-key">Y</span></td>
      <td><span class="csguide-key">F8</span></td>
    </tr>
  </tbody>
</table>

<h2>Column Widths</h2>

<p>Use the <span class="csguide-command">Auto Width</span> command
to ensure that each column is the correct width for its contents:</p>

<table class="csguide-command-table">
  <col />
  <col />
  <col />
  <col />
  <tbody>
    <tr>
      <th class="csgcth-menu">Menu</th>
      <th class="csgcth-command">Command</th>
      <th class="csgcth-ctrl">Ctrl-sequence</th>
      <th class="csgcth-key">Key</th>
    </tr>
    <tr>
      <td>Layout</td>
      <td>Auto width</td>
      <td><span class="csguide-key">LAW</span></td>
      <td></td>
    </tr>
  </tbody>
</table>

<h2>Database Functions</h2>

<p>PipeDream provides a number of database functions which enable
you to produce statistics about selected records in your database. The
records are selected by the condition which forms the second part of
the database function.</p>

<p>For example, you can use the function DCOUNTA to find out how
many of your pupils study history:</p>

<ol>
  <li>Position the caret in an unused cell such as A40.</li>
  <li>Click Select in the formula line.</li>
  <li>Type the following:</li>
</ol>

<p style="margin-left:2em;"><code>DCOUNTA(D3D39, D3D39=&quot;H&quot;)</code></p>

<ol start="4">
  <li>Press <span class="csguide-key">Enter</span> or click Select on the tick box.</li>
</ol>

<p>The number of pupils who study history appears in the cell containing the DCOUNTA formula.</p>

<p>D3D39 is the range of cells upon which you want to carry out the
function i.e. all cells from D3 to D39 inclusive.</p>

<p>D3D39=&quot;H&quot; is the condition. You only want to count the cells in the
range D3D39 which contain H.</p>

<p>Note that the parameters of the function are enclosed within brackets
and any text, in this case H, within double quotation marks.</p>

<p>If you want to know the average physics exam result:</p>

<ol>
  <li>Position the caret in a blank cell such as F41.</li>
  <li>Click Select in the formula line.</li>
  <li>Type the following:</li>
</ol>

<p style="margin-left:2em;"><code>DAVG(F3F39, D3D39=&quot;P&quot;)</code></p>

<ol start="4">
  <li>Press <span class="csguide-key">Enter</span> or click Select on the tick box.</li>
</ol>

<p>The average physics result appears in the cell.</p>

<p>There are many other database functions which are explained fully in
the <a href="../refguide/databasefns.html">Database Functions</a> section
of the <a href="../refguide/index.html">Reference Guide</a>.</p>

<div class="navfooter">
<hr/>
<table width="100%" summary="Navigation footer">
<tr>
<td width="40%" align="left"><a accesskey="p" href="spreadsheets.html">Prev</a> </td>
<td width="20%" align="center"></td>
<td width="40%" align="right"> <a accesskey="n" href="combineddocuments.html">Next</a></td>
</tr>
<tr>
<td width="40%" align="left" valign="top">Spreadsheets </td>
<td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td>
<td width="40%" align="right" valign="top"> Combined Documents</td>
</tr>
</table>
</div>
</body>
</html>
