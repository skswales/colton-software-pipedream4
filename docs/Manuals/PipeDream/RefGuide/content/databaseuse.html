<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">

    <!-- This Source Code Form is subject to the terms of the Mozilla Public
       - License, v. 2.0. If a copy of the MPL was not distributed with this
       - file, You can obtain one at https://mozilla.org/MPL/2.0/. -->
    <!-- Copyright © 1991-1998 Colton Software Limited
       - Copyright © 1998-2015 R W Colton -->

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Database Use</title>
    <link href="guide.css" rel="stylesheet" type="text/css">
    <style type="text/css">
        .transpose-example-column-width {
            width: 192px;
        }
    </style>
</head>
<body>
    <nav class="navheader">
        <table>
            <tr>
                <td><a accesskey="p" href="functions/database.html">Prev</a> </td>
                <td><a href="../index.html">Contents</a> </td>
                <th>PipeDream Reference Guide</th>
                <td> <a href="fullindex.html">Index</a></td>
                <td> <a accesskey="n" href="datetime.html">Next</a></td>
            </tr>
        </table>
    </nav>

    <h1 id="Database">Database Use</h1>
    <p>
        You can use PipeDream to store a database of records.
        PipeDream provides facilities to sort your records on one or more fields.
        You can save out only those records which satisfy one or more conditions which you specify or those records which satisfy one of several specified conditions.
        PipeDream also provides several database functions which enable you to manipulate your records in various ways.
    </p>

    <h2 id="Entering">Entering Records</h2>
    <p>You can enter records in two different ways:</p>
    <ul>
        <li>As single-row records</li>
        <li>As multi-row records</li>
    </ul>

    <h2 id="Single-Row">Single-Row Records</h2>
    <p>
        Each record takes up just one row in the document.
        On sorting, each row is considered as a separate record.
        Most databases have single row records.
    </p>

    <h4>Converting Existing Data to Single-Row Records</h4>
    <p>If you have entered some names and addresses like this:</p>
    <table border="1" class="csg-sample-indent csg-sample">
        <col>
        <tbody>
            <tr>
                <td class="transpose-example-column-width">Mr. R.T. Smith.</td>
            </tr>
            <tr>
                <td>3, The Drive,</td>
            </tr>
            <tr>
                <td>Tonbridge,</td>
            </tr>
            <tr>
                <td>Kent.</td>
            </tr>
            <tr>
                <td>&nbsp;</td>
            </tr>
            <tr>
                <td>Mr &amp; Mrs. G. Fox</td>
            </tr>
            <tr>
                <td>192b High Street</td>
            </tr>
            <tr>
                <td>Cambridge,</td>
            </tr>
            <tr>
                <td>Cambs.</td>
            </tr>
            <tr>
                <td>&nbsp;</td>
            </tr>
            <tr>
                <td>Mr. J. FitzHenry</td>
            </tr>
            <tr>
                <td>"RiverView",</td>
            </tr>
            <tr>
                <td>Sevenoaks,</td>
            </tr>
            <tr>
                <td>Kent.</td>
            </tr>
        </tbody>
    </table>
    <p>and then realise that you actually wanted to enter them as single-row records like this:</p>
    <table border="1" class="csg-sample-indent csg-sample">
        <col>
        <col>
        <col>
        <col>
        <tbody>
            <tr>
                <td class="transpose-example-column-width">Mr. R.T. Smith.</td>
                <td class="transpose-example-column-width">3, The Drive,</td>
                <td class="transpose-example-column-width">Tonbridge,</td>
                <td class="transpose-example-column-width">Kent.</td>
            </tr>
            <tr>
                <td>&nbsp;</td>
                <td>&nbsp;</td>
                <td>&nbsp;</td>
                <td>&nbsp;</td>
            </tr>
            <tr>
                <td>Mr &amp; Mrs. G. Fox</td>
                <td>192b High Street</td>
                <td>Cambridge,</td>
                <td>Cambs.</td>
            </tr>
            <tr>
                <td></td>
                <td>&nbsp;</td>
                <td>&nbsp;</td>
                <td>&nbsp;</td>
            </tr>
            <tr>
                <td>Mr. J. FitzHenry</td>
                <td>"RiverView",</td>
                <td>Sevenoaks,</td>
                <td>Kent.</td>
            </tr>
        </tbody>
    </table>
    <p>all you have to do is mark each name and address like this:</p>
    <table border="1" class="csg-sample-indent csg-sample">
        <col>
        <col>
        <col>
        <col>
        <tbody>
            <tr>
                <td class="transpose-example-column-width">Mr. R.T. Smith.</td>
                <td class="transpose-example-column-width">3, The Drive,</td>
                <td class="transpose-example-column-width">Tonbridge,</td>
                <td class="transpose-example-column-width">Kent.</td>
            </tr>
            <tr>
                <td>&nbsp;</td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td style="color:#ffffff;background-color:#400040">
                    Mr &amp; Mrs. G.
                    Fox
                </td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td style="color:#ffffff;background-color:#400040">192b High Street</td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td style="color:#ffffff;background-color:#400040">Cambridge,</td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td style="color:#ffffff;background-color:#400040">Cambs.</td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>&nbsp;</td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>Mr. J. FitzHenry</td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>"RiverView",</td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>Sevenoaks,</td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>Kent.</td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
        </tbody>
    </table>
    <p>and give the <span class="csg-command">Transpose Blocks</span> command:</p>
    <table class="csg-command-table">
        <col>
        <col>
        <col>
        <col>
        <col>
        <tbody>
            <tr>
                <th class="csg-ct-th-menu">Menu</th>
                <th class="csg-ct-th-command">Command</th>
                <th class="csg-ct-th-tool">Tool</th>
                <th class="csg-ct-th-key-none">Key</th>
                <th class="csg-ct-th-cmdseq">Cmd-sequence</th>
            </tr>
            <tr>
                <td>Blocks</td>
                <td>Transpose blocks</td>
                <td><span class="csg-mouse-button">Adjust</span> <img src="images/toolbar/sort.png" alt="Sort icon" style="vertical-align: bottom;"></td>
                <td></td>
                <td><span class="csg-cmdseq">BT</span></td>
            </tr>
        </tbody>
    </table>

    <h3 id="Sort">Sorting Records</h3>
    <p>
        You can sort the records in your database on any column, in either ascending order or descending order.
        You can also sort on several columns, one after the other in the order you specify.
        If sorting on several columns, you can specify ascending or descending order separately for each column.
    </p>
    <ul>
        <li>Text cells and strings are sorted alphabetically</li>
        <li>Number cells are sorted in numerical order of their value</li>
        <li>Dates are sorted in date order</li>
    </ul>
    <ol>
        <li>
            Mark the block of cells you want to sort.
            If you want to sort the whole document, click the mark block box to mark the whole document.
        </li>
        <li>Give the <span class="csg-command">Sort</span> command:</li>
    </ol>
    <table class="csg-command-table">
        <col>
        <col>
        <col>
        <col>
        <col>
        <tbody>
            <tr>
                <th class="csg-ct-th-menu">Menu</th>
                <th class="csg-ct-th-command">Command</th>
                <th class="csg-ct-th-tool">Tool</th>
                <th class="csg-ct-th-key-none">Key</th>
                <th class="csg-ct-th-cmdseq">Cmd-sequence</th>
            </tr>
            <tr>
                <td>Blocks</td>
                <td>Sort</td>
                <td><img src="images/toolbar/sort.png" alt="Sort icon"></td>
                <td></td>
                <td><span class="csg-cmdseq">BSO</span></td>
            </tr>
        </tbody>
    </table>
    <!-- ol start="3" -->
    <ul class="csg-netsurf-2434">
        <li>
            3. When the dialogue box appears, type in the column or columns you want to be sorted.
            PipeDream supplies the column containing the caret as a default.
        </li>
    </ul>
    <p>
        By default, the sort will be in ascending order.
        This means that the smallest item will be put first and the largest at the bottom.
        To reverse this, click the <span class="csg-dbox-option">Ascending order</span> option to turn it off.
    </p>
    <p>
        You can set this option for each column you type in.
        If you do not type in a column reference, the sort will take place on the column containing the caret.
        Note that part of or all of the column must be within the marked block.
    </p>

    <h2 id="Multi-Row">Multi-Row Records</h2>
    <p>
        Databases can be built which have records containing paragraphs of text.
        A record in the database can be one row or it may be more than one row.
    </p>
    <p>
        Note that you can sort multi-row records but you cannot do row selections or mailshots
        with them as these two operations assume that each row is a separate record.
        For this reason, it is usually best to have your databases comprising just single row records.
    </p>

    <h3 id="Sortmulti">Sorting Multi-Row Records</h3>
    <p>If you want to be able to sort records consisting of more than one line, you need to enter your records in the following way:</p>
    <table border="1" class="csg-sample-indent csg-sample">
        <col>
        <col>
        <col>
        <tbody>
            <tr>
                <th class="csg-sample-sheet-border-column"></th>
                <th class="csg-sample-sheet-border-column">A</th>
                <th class="csg-sample-sheet-border-column">B</th>
            </tr>
            <tr>
                <th class="csg-sample-sheet-border-row">1</th>
                <td>British Blue</td>
                <td>The British Blue has a sturdy body and shortish</td>
            </tr>
            <tr>
                <th class="csg-sample-sheet-border-row">2</th>
                <td></td>
                <td>legs. Its fur is thick and short and an even</td>
            </tr>
            <tr>
                <th class="csg-sample-sheet-border-row">3</th>
                <td></td>
                <td>grey colour. Its eyes are deep red copper. It is</td>
            </tr>
            <tr>
                <th class="csg-sample-sheet-border-row">4</th>
                <td></td>
                <td>usually friendly with everybody.</td>
            </tr>
            <tr>
                <th class="csg-sample-sheet-border-row">5</th>
                <td>Seal Point Siamese</td>
                <td>The Seal Point Siamese has dark brown &#39;points&#39;</td>
            </tr>
            <tr>
                <th class="csg-sample-sheet-border-row">6</th>
                <td></td>
                <td>- ears, mask, legs and tail, contrasting with a</td>
            </tr>
            <tr>
                <th class="csg-sample-sheet-border-row">7</th>
                <td></td>
                <td>cream body. Its fur is smooth and silky. Its</td>
            </tr>
            <tr>
                <th class="csg-sample-sheet-border-row">8</th>
                <td></td>
                <td>eyes should be china blue. It is very friendly</td>
            </tr>
            <tr>
                <th class="csg-sample-sheet-border-row">9</th>
                <td></td>
                <td>and rather noisy.</td>
            </tr>
            <tr>
                <th class="csg-sample-sheet-border-row">10</th>
                <td>Brown Tabby Persian</td>
                <td>The Brown Tabby Persian has the typical flat</td>
            </tr>
            <tr>
                <th class="csg-sample-sheet-border-row">11</th>
                <td></td>
                <td>Persian Face, with golden eyes. Its long, thick</td>
            </tr>
            <tr>
                <th class="csg-sample-sheet-border-row">12</th>
                <td></td>
                <td>fur has even tabby markings with a cream chin</td>
            </tr>
            <tr>
                <th class="csg-sample-sheet-border-row">13</th>
                <td></td>
                <td>and black &#39;slippers&#39;. It can be rather timid</td>
            </tr>
            <tr>
                <th class="csg-sample-sheet-border-row">14</th>
                <td></td>
                <td>but is very friendly with those it trusts.</td>
            </tr>
        </tbody>
    </table>
    <p>
        When you sort such records, you must have the
        <span class="csg-dbox-option">Multi-row records</span> option in the
        <span class="csg-dbox">Sort</span> dialogue box turned on.
        The blank cells between the multi-row records ensure that when you sort the records on column A, all the rows in the record will be kept together.
        So, you can specify a sort on column A to get the cats in alphabetical order.
        The result would be as follows:
    </p>
    <table border="1" class="csg-sample-indent csg-sample">
        <col>
        <col>
        <col>
        <tbody>
            <tr>
                <th class="csg-sample-sheet-border-column"></th>
                <th class="csg-sample-sheet-border-column">A</th>
                <th class="csg-sample-sheet-border-column">B</th>
            </tr>
            <tr>
                <th class="csg-sample-sheet-border-row">1</th>
                <td>British Blue</td>
                <td>The British Blue has a sturdy body and shortish</td>
            </tr>
            <tr>
                <th class="csg-sample-sheet-border-row">2</th>
                <td></td>
                <td>legs. Its fur is thick and short and an even</td>
            </tr>
            <tr>
                <th class="csg-sample-sheet-border-row">3</th>
                <td></td>
                <td>grey colour. Its eyes are deep red copper. It is</td>
            </tr>
            <tr>
                <th class="csg-sample-sheet-border-row">4</th>
                <td></td>
                <td>usually friendly with everybody.</td>
            </tr>
            <tr>
                <th class="csg-sample-sheet-border-row">5</th>
                <td>Brown Tabby Persian</td>
                <td>The Brown Tabby Persian has the typical flat</td>
            </tr>
            <tr>
                <th class="csg-sample-sheet-border-row">6</th>
                <td></td>
                <td>Persian Face, with golden eyes. Its long, thick</td>
            </tr>
            <tr>
                <th class="csg-sample-sheet-border-row">7</th>
                <td></td>
                <td>fur has even tabby markings with a cream chin</td>
            </tr>
            <tr>
                <th class="csg-sample-sheet-border-row">8</th>
                <td></td>
                <td>and black &#39;slippers&#39;. It can be rather timid</td>
            </tr>
            <tr>
                <th class="csg-sample-sheet-border-row">9</th>
                <td></td>
                <td>but is very friendly with those it trusts.</td>
            </tr>
            <tr>
                <th class="csg-sample-sheet-border-row">10</th>
                <td>Seal Point Siamese</td>
                <td>The Seal Point Siamese has dark brown &#39;points&#39;</td>
            </tr>
            <tr>
                <th class="csg-sample-sheet-border-row">11</th>
                <td></td>
                <td>- ears, mask, legs and tail, contrasting with a</td>
            </tr>
            <tr>
                <th class="csg-sample-sheet-border-row">12</th>
                <td></td>
                <td>cream body. Its fur is smooth and silky. Its</td>
            </tr>
            <tr>
                <th class="csg-sample-sheet-border-row">13</th>
                <td></td>
                <td>eyes should be china blue. It is very friendly</td>
            </tr>
            <tr>
                <th class="csg-sample-sheet-border-row">14</th>
                <td></td>
                <td>and rather noisy.</td>
            </tr>
        </tbody>
    </table>

    <h2 id="Saving">Saving Selected Records From Your Database</h2>
    <p>
        You can save to a file those records which satisfy one or more conditions you specify,
        such as all the cars in your database which are both red and have five doors.
        You can save all those records which satisfy one of several conditions you specify,
        such as all the cars in your database which are manufactured either in Germany or in France.
    </p>
    <ol>
        <li>Give the <span class="csg-command">Save</span> command.</li>
        <li>When the <span class="csg-dbox">Save</span> dialogue box appears, select the <span class="csg-dbox-option">Save selection of rows</span> option.</li>
        <li>Type in the condition you want to apply.</li>
    </ol>
    <p>
        The formula you type in will be evaluated before each row (record) is saved.
        Only if the result is true will the row be saved.
        The formula will normally contain cell references.
        These are updated by one row for each new line.
    </p>
    <p>
        For example, if you enter <code>B1B100&gt;100</code> as the condition,
        all rows where the second column evaluates to a number greater than 100 will be saved.
        On row 1, the condition will be <code>B1&gt;100</code>.
        On row 2, the condition will change to <code>B2&gt;100</code>,
        on row 3 to <code>B3&gt;100</code>,
        on row 4 to <code>B4&gt;100</code>, etc.
    </p>
    <p>You can include text strings in the condition, but they must be placed within double quotation marks.</p>
    <h5>Example:</h5>
    <p>
        The condition <code>A1A100&gt;"Fred"</code> will save all lines lying alphabetically after Fred,
        such as <code>"Tom"</code> and <code>"Harry"</code> but not <code>"Dick"</code>.
    </p>
    <p>
        A string can contain the wildcards
        <code>^?</code> (any single character) and
        <code>^#</code> (any multiple character).
        All string comparisons treat lower-case and upper-case letters as the same.
    </p>
    <p>You can save rows which satisfy more than one condition by using the <code>&amp;</code> operator.</p>
    <p><b>Example:</b> (here we are just showing the first ten rows of a 100 row database):</p>
    <table border="1" class="csg-sample-indent csg-sample">
        <col>
        <col>
        <col>
        <col>
        <tbody>
            <tr>
                <th class="csg-sample-sheet-border-column"></th>
                <th class="csg-sample-sheet-border-column">A</th>
                <th class="csg-sample-sheet-border-column">B</th>
                <th class="csg-sample-sheet-border-column">C</th>
            </tr>
            <tr>
                <th class="csg-sample-sheet-border-row">1</th>
                <td>A. Jones</td>
                <td>Weymouth</td>
                <td>Ford Fiesta</td>
            </tr>
            <tr>
                <th class="csg-sample-sheet-border-row">2</th>
                <td>B. Smith</td>
                <td>Cambridge</td>
                <td>VW Polo</td>
            </tr>
            <tr>
                <th class="csg-sample-sheet-border-row">3</th>
                <td>C. Thompson</td>
                <td>Lancaster</td>
                <td>Vauxhall Cavalier</td>
            </tr>
            <tr>
                <th class="csg-sample-sheet-border-row">4</th>
                <td>D. Reed</td>
                <td>Weymouth</td>
                <td>Citroen BX</td>
            </tr>
            <tr>
                <th class="csg-sample-sheet-border-row">5</th>
                <td>E. Baker</td>
                <td>Halifax</td>
                <td>VW Golf</td>
            </tr>
            <tr>
                <th class="csg-sample-sheet-border-row">6</th>
                <td>F. Baxter</td>
                <td>Cambridge</td>
                <td>Citroen BX</td>
            </tr>
            <tr>
                <th class="csg-sample-sheet-border-row">7</th>
                <td>G. Parker</td>
                <td>Cambridge</td>
                <td>VW Golf</td>
            </tr>
            <tr>
                <th class="csg-sample-sheet-border-row">8</th>
                <td>H. Walker</td>
                <td>Norwich</td>
                <td>Ford Fiesta</td>
            </tr>
            <tr>
                <th class="csg-sample-sheet-border-row">9</th>
                <td>I. Potter</td>
                <td>Cambridge</td>
                <td>VW Golf</td>
            </tr>
            <tr>
                <th class="csg-sample-sheet-border-row">10</th>
                <td>J. Brown</td>
                <td>Cambridge</td>
                <td>VW Passat</td>
            </tr>
        </tbody>
    </table>
    <p> To save all those who live in Cambridge and drive a VW Golf, you would use the condition:</p>
    <p class="csg-sample-indent csg-user-text">B1B100="Cambridge" &amp; C1C100="VW Golf"</p>
    <p>To save all those who live in Cambridge and drive any type of VW, you would use the condition:</p>
    <p class="csg-sample-indent csg-user-text">B1B100="Cambridge" &amp; C1C100="VW^#"</p>
    <p>You can also use the <code>|</code> (vertical bar) operator to save those rows which satisfy one of a number of conditions.</p>
    <p>Still using the above example database, to save those who either live in Weymouth or drive a Citroen BX, you would use the condition:</p>
    <p class="csg-sample-indent csg-user-text">B1B100="Weymouth" | C1C100="Citroen BX"</p>

    <nav class="navfooter">
        <table>
            <tr>
                <td>Database Functions </td>
                <td></td>
                <td> Dates and Times</td>
            </tr>
            <tr>
                <td><a accesskey="p" href="functions/database.html">Prev</a> </td>
                <td><a accesskey="h" href="../index.html">Home</a></td>
                <td> <a accesskey="n" href="datetime.html">Next</a></td>
            </tr>
        </table>
    </nav>
</body>
</html>
