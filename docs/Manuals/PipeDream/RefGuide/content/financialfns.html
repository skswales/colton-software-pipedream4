<?xml version="1.0" encoding="iso-8859-1" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <meta http-equiv="content-type" content="text/html; charset=iso-8859-1" />
    <title>Financial Functions</title>
    <link href="csguide.css" rel="stylesheet" type="text/css" />
</head>
<body>
    <!-- This Source Code Form is subject to the terms of the Mozilla Public
       - License, v. 2.0. If a copy of the MPL was not distributed with this
       - file, You can obtain one at http://mozilla.org/MPL/2.0/. -->
    <!-- Copyright (C) 1991-1998 Colton Software Limited
       - Copyright (C) 1998-2015 R W Colton -->
    <div class="navheader">
        <table id="navheader" summary="Navigation header">
            <tr>
                <td id="navheader_PCN_L"><a accesskey="p" href="fileops.html">Prev</a> </td>
                <td id="navheader_PCN_LC"><a href="../index.html">Contents</a> </td>
                <th id="navheader_PCN_C">PipeDream Reference Guide</th>
                <td id="navheader_PCN_CR"> <a href="fullindex.html">Index</a></td>
                <td id="navheader_PCN_R"> <a accesskey="n" href="firstwordplus.html">Next</a></td>
            </tr>
        </table>
    </div>

    <h1 id="Financial">Financial Functions</h1>
    <p>
        The following financial functions are provided by PipeDream.
        There is an example of each financial function in the PipeDream Examples.
    </p>

    <h2 class="csg-function" id="CTERM">CTERM</h2>
    <p>
        Returns the number of compounding periods (usually years)
        required for an investment at a present value to reach a future value
        to reach a future value earning a fixed interest rate.
    </p>
    <h5>Syntax:</h5>
    <p class="csg-function-declaration">
        CTERM(<span class="csg-function-parameter">interest</span>,
        <span class="csg-function-parameter">future_value</span>,
        <span class="csg-function-parameter">present_value</span>)
    </p>
    <table>
        <tr>
            <td class="csg-function-parameter">interest</td>
            <td>is the interest rate per period, expressed as a decimal fraction</td>
        </tr>
        <tr>
            <td class="csg-function-parameter">future_value</td>
            <td>is the desired future value of the investment</td>
        </tr>
        <tr>
            <td class="csg-function-parameter">present_value&nbsp;</td>
            <td>is the present value of the investment</td>
        </tr>
    </table>
    <p>The formula underlying <code>CTERM</code> is:</p>
    <p class="csg-function-formula">periods = ln(<i>future_value</i> &divide; <i>present_value</i>) &divide; ln(1 + <i>interest</i>)</p>
    <h5>Example:</h5>
    <p>
        How long does it take to turn &pound;1000 into &pound;2000 at a fixed rate of 10% per year?
        The answer is calculated with the formula <code>CTERM(0.10,2000,1000)</code>.
        The answer in this case is 7.27 years.
    </p>

    <h2 class="csg-function" id="DDB">DDB</h2>
    <p>Returns the calculated depreciation allowance on an asset at a specific period of time using the double declining balance method.</p>
    <h5>Syntax:</h5>
    <p class="csg-function-declaration">
        DDB(<span class="csg-function-parameter">cost</span>,
        <span class="csg-function-parameter">salvage&nbsp;</span>,
        <span class="csg-function-parameter">life</span>,
        <span class="csg-function-parameter">period</span>,
        {,&nbsp;<span class="csg-function-parameter">factor</span>:<span class="csg-function-parameter-type">number</span>})
    </p>
    <table>
        <tr>
            <td class="csg-function-parameter">cost</td>
            <td>is the original value</td>
        </tr>
        <tr>
            <td class="csg-function-parameter">salvage&nbsp;</td>
            <td>is the value at the end of the life</td>
        </tr>
        <tr>
            <td class="csg-function-parameter">life</td>
            <td>is the number of periods for which you want to calculate the depreciation allowance</td>
        </tr>
        <tr>
            <td class="csg-function-parameter">period</td>
            <td>is the period for which the depreciation is being measured</td>
        </tr>
        <tr>
            <td class="csg-function-parameter">factor</td>
            <td>is the rate at which the balance declines. Default is 2.0</td>
        </tr>
    </table>
    <h5>Example:</h5>
    <p>
        You pay &pound;5000 for a machine that will have a salvage value of &pound;1000 at the end of 5 years.
        What is the depreciation in the first year?
        The formula to find out is <code>DDB(5000,1000,5,1)</code> which returns &pound;2000, the depreciation allowance for the first year.
    </p>
    <h5>Revision:</h5>
    <p>Starting with 4.56, this function accepts an optional extra parameter, <span class="csg-function-parameter">factor</span>.</p>

    <h2 class="csg-function" id="FV">FV</h2>
    <p>Computes the future value of an investment based on a number of equal payments, each earning interest at a periodic rate, over a specified term.</p>
    <h5>Syntax:</h5>
    <p class="csg-function-declaration">
        FV(<span class="csg-function-parameter">payment</span>,
        <span class="csg-function-parameter">interest</span>,
        <span class="csg-function-parameter">term</span>)
    </p>
    <table>
        <tr>
            <td class="csg-function-parameter">payment</td>
            <td>is the amount of each individual payment</td>
        </tr>
        <tr>
            <td class="csg-function-parameter">interest&nbsp;</td>
            <td>is the interest rate, expressed as a decimal fraction</td>
        </tr>
        <tr>
            <td class="csg-function-parameter">term</td>
            <td>is the number of periods during which payments will be made</td>
        </tr>
    </table>
    <p><code>FV</code> uses the following formula to calculate future value:</p>
    <p class="csg-function-formula">future value = <i>payment</i> &times; ((1 + <i>interest</i>)<sup><i>term</i></sup> &minus; 1) &divide; <i>interest</i></p>
    <h5>Example:</h5>
    <p>
        You put &pound;400 annually into an account which earns 5% per annum.
        What is the value of the account after 25 years?
        The formula <code>FV(400,0.05,25)</code> calculates the result, &pound;19,090.84.
    </p>

    <h2 class="csg-function" id="IRR">IRR</h2>
    <p>Returns the calculated internal rate of return of an initial series of expected returns, based on an initial guess.</p>
    <h5>Syntax:</h5>
    <p class="csg-function-declaration">
        IRR(<span class="csg-function-parameter">guess</span>,
        <span class="csg-function-parameter">data</span>)
    </p>
    <table>
        <tr>
            <td class="csg-function-parameter">guess&nbsp;</td>
            <td>The guessed rate of return, entered as a decimal fraction</td>
        </tr>
        <tr>
            <td class="csg-function-parameter">data</td>
            <td>
                The initial investment should be entered as a negative number in the first cell in the range or element of the array.
                Further cells in the range or elements of the array should contain positive numbers, the expected returns on the investment.
            </td>
        </tr>
    </table>
    <h5>Example:</h5>
    <p>
        Cell A1 contains the initial investment -5000 (note that this is entered as a negative number because you are spending it).
        Cells A2 to A14 each contain the number 500, representing payments returned on the investment.
        Cell A16 contains the number 0.01, a first guess for the internal rate of return (1%).
        The formula <code>IRR(A16,A1A14)</code> displays the result 0.04, the internal percentage rate of return (4%) for the cash flows in column A.
    </p>

    <h2 class="csg-function" id="MIRR">MIRR</h2>
    <p>Returns the modified internal rate of return for a series of periodic cash flows.</p>
    <h5>Syntax:</h5>
    <p class="csg-function-declaration">
        MIRR(<span class="csg-function-parameter">values</span>:array_or_range,
        <span class="csg-function-parameter">finance_rate</span>,
        <span class="csg-function-parameter">reinvest_rate</span>)
    </p>
    <table>
        <tr valign="top">
            <td class="csg-function-parameter">values</td>
            <td>an array or a range of cells which contain numbers representing payments (negative numbers) and receipts (positive numbers) occurring at regular periods</td>
        </tr>
        <tr valign="top">
            <td class="csg-function-parameter">finance_rate</td>
            <td>the interest rate you pay</td>
        </tr>
        <tr valign="top">
            <td class="csg-function-parameter">reinvest_rate&nbsp;</td>
            <td>the interest rate you receive on reinvested cash</td>
        </tr>
    </table>
    <p>MIRR considers both the cost of the investment and the interest received on reinvestment of the cash.</p>
    <h5>Example:</h5>
    <p>
        You are a potter just completing your third year in business.
        Three years ago, you borrowed &pound;120,000 at 10% annual interest to buy a workshop and equipment.
        Your annual income for the past three years has been &pound;39,000, &pound;30,000, and &pound;21,000.
        During these years, you reinvested your profits, earning 12% annually.
        If you enter the initial cost as a negative number in cell B1 and the annual incomes in cells B2, B3 and B4,
        to calculate the investment&rsquo;s modified rate of return after 3 years, you would type
        <code>MIRR(B1B4,.10,.12)</code> which would return -0.04804 as the result.
    </p>

    <h2 class="csg-function" id="NPV">NPV</h2>
    <p>Returns the net present value of a series of future receipts at a fixed periodic interest rate.</p>
    <h5>Syntax:</h5>
    <p class="csg-function-declaration">
        NPV(<span class="csg-function-parameter">interest</span>,
        <span class="csg-function-parameter">range</span>)
    </p>
    <table>
        <tr valign="top">
            <td class="csg-function-parameter">interest&nbsp;</td>
            <td>is the interest rate</td>
        </tr>
        <tr valign="top">
            <td class="csg-function-parameter">range</td>
            <td>is the range of cells containing the amounts of the receipts</td>
        </tr>
    </table>
    <p>It is assumed that the receipts are at equal intervals and take place at the end of the period.</p>
    <p>The following formula is used to calculate net present value:</p>
    <p class="csg-function-formula">
        net present value =
        <span class="csg-greek-symbol">&Sigma;</span><sup><i>i</i>=<i>n</i></sup>
        ( <i>v</i><sub><i>i</i></sub> &divide; (1 + <i>interest</i>)<sup><i>i</i></sup> )
    </p>
    <h5>Example:</h5>
    <p>
        Cells B10 to B14 each contain the number 120 each representing a cash flow.
        What is the net present value of the cash flows given a discount rate of 10%?
        The formula <code>NPV(0.10,B10B14)</code> displays the result &pound;454.89, the present value of the future cash flows.
    </p>

    <h2 class="csg-function" id="PMT">PMT</h2>
    <p>Returns the payment on a loan.</p>
    <h5>Syntax:</h5>
    <p class="csg-function-declaration">
        PMT(<span class="csg-function-parameter">principal</span>,
        <span class="csg-function-parameter">interest</span>,
        <span class="csg-function-parameter">term</span>)
    </p>
    <p>Calculates the payment on a loan given:</p>
    <table>
        <tr>
            <td class="csg-function-parameter">principal&nbsp;</td>
            <td>is the amount of the loan</td>
        </tr>
        <tr>
            <td class="csg-function-parameter">interest</td>
            <td>is the rate of the interest</td>
        </tr>
        <tr>
            <td class="csg-function-parameter">term</td>
            <td>is the term of the loan (number of periods)</td>
        </tr>
    </table>
    <p>To calculate monthly payments given an annual percentage rate, and a term in years, divide the interest rate by 12 and multiply the term by 12.</p>
    <p>The following formula is used to calculate the payment:</p>
    <p class="csg-function-formula">payment = <i>principal</i> &times; ( <i>interest</i> &divide; (1 &minus; (1 + <i>interest</i>)<sup>-<i>term</i></sup>) )</p>
    <h5>Example:</h5>
    <p>
        What is the monthly payment on a loan of &pound;150,000, given a 10% annual interest rate and a term of 20 years?
        The formula <code>PMT(150000,0.10/12,20*12)</code> returns the correct monthly payment, &pound;1447.53.
    </p>

    <h2 class="csg-function" id="PV">PV</h2>
    <p>Computes the present value of a series of equal payments discounted at a periodic interest rate for a term.</p>
    <h5>Syntax:</h5>
    <p class="csg-function-declaration">
        PV(<span class="csg-function-parameter">payment</span>,
        <span class="csg-function-parameter">interest&nbsp;</span>,
        <span class="csg-function-parameter">term</span>)
    </p>
    <table>
        <tr>
            <td class="csg-function-parameter">payment</td>
            <td>is the regular payment made</td>
        </tr>
        <tr>
            <td class="csg-function-parameter">interest</td>
            <td>is the rate of interest per period the payments will receive</td>
        </tr>
        <tr>
            <td class="csg-function-parameter">term</td>
            <td>is the length of the investment in periods</td>
        </tr>
    </table>
    <p>The following formula is used to calculate the present value:</p>
    <p class="csg-function-formula">present value = <i>payment</i> &times; ( (1 &minus; (1 + <i>interest</i>)<sup>-<i>term</i></sup>) &divide; <i>interest</i> )</p>
    <h5>Example:</h5>
    <p>
        You are considering starting a trust fund for your grandson, where you pay &pound;2000 a year for 30 years.
        Given that you could earn 12% by investing your money elsewhere, what is the present value of the trust fund, including the interest that you won&rsquo;t earn?
        The formula <code>PV(2000,0.12,30)</code> returns &pound;16110.37, the cash value of the trust fund in today&rsquo;s pounds.
    </p>

    <h2 class="csg-function" id="RATE">RATE</h2>
    <p>Returns the periodic interest rate required for an investment at a present value to reach a future value within a given period of time.</p>
    <h5>Syntax:</h5>
    <p class="csg-function-declaration">
        RATE(<span class="csg-function-parameter">future_value</span>,
        <span class="csg-function-parameter">present_value</span>,
        <span class="csg-function-parameter">term</span>)
    </p>
    <table>
        <tr>
            <td class="csg-function-parameter">future_value</td>
            <td>Future value</td>
        </tr>
        <tr>
            <td valign="top"><span class="csg-function-parameter">present_value&nbsp;</span></td>
            <td>
                Present value.<br />
                Future and present values must be expressed in equivalent units (e.g. in the same currency)
            </td>
        </tr>
        <tr>
            <td class="csg-function-parameter">term</td>
            <td>Period of the investment</td>
        </tr>
    </table>
    <p>The following formula is used to calculate the interest rate:</p>
    <p class="csg-function-formula">interest = ( (<i>future_value</i> &divide; <i>present_value</i>) <sup>1/<i>term</i></sup> ) &minus; 1</p>
    <h5>Example:</h5>
    <p>
        25 years from now, you want to retire with &pound;1,000,000 in the bank.
        You have &pound;50,000 to put into a pension fund.
        How much interest (compounded monthly) will you need to earn to accumulate the million pounds?
        The answer is given by the formula <code>RATE(1000000,50000,25*12)</code> .
        The answer is 0.01, which you multiply by 12 to get the annual interest rate of 12% (0.12).
    </p>

    <h2 class="csg-function" id="SLN">SLN</h2>
    <p>Computes the straight line depreciation allowance of an asset for any given period.</p>
    <h5>Syntax:</h5>
    <p class="csg-function-declaration">
        SLN(<span class="csg-function-parameter">cost</span>,
        <span class="csg-function-parameter">salvage</span>,
        <span class="csg-function-parameter">life</span>)
    </p>
    <table>
        <tr>
            <td class="csg-function-parameter">cost</td>
            <td>is the original value of the asset</td>
        </tr>
        <tr valign="top">
            <td class="csg-function-parameter">salvage&nbsp;</td>
            <td>
                is the predicted future value at the end of the depreciation period.
                Both cost and salvage must be presented in the same units (e.g. both in the same currency)
            </td>
        </tr>
        <tr>
            <td class="csg-function-parameter">life</td>
            <td>is the period for which depreciation is being calculated</td>
        </tr>
    </table>
    <p>The result returned is the straight line depreciation of the asset over the specified period.</p>
    <p>The following formula is used to calculate the depreciation:</p>
    <p class="csg-function-formula">depreciation = (<i>cost</i> &minus; <i>salvage</i>) &divide; <i>life</i></p>
    <h5>Example:</h5>
    <p>
        You buy a computer for &pound;500 which has a salvage value of &pound;100 in five years.
        In any given year, the depreciation allowance is given by the formula
        <code>SLN(500,100,5)</code> which returns &pound;80.00.
    </p>

    <h2 class="csg-function" id="SYD">SYD</h2>
    <p>Determines the depreciation allowance of a given year using the sum-of-years&rsquo; digits method.</p>
    <h5>Syntax:</h5>
    <p class="csg-function-declaration">
        SYD(<span class="csg-function-parameter">cost</span>,
        <span class="csg-function-parameter">salvage</span>,
        <span class="csg-function-parameter">life</span>,
        <span class="csg-function-parameter">period</span>)
    </p>
    <table>
        <tr>
            <td class="csg-function-parameter">cost</td>
            <td>is the original value of the asset</td>
        </tr>
        <tr valign="top">
            <td class="csg-function-parameter">salvage&nbsp;</td>
            <td>
                is the predicted future value at the end of the depreciation period.
                Both cost and salvage must be presented in the same units (e.g. both in the same currency)
            </td>
        </tr>
        <tr>
            <td>
                <span class="csg-function-parameter">life</span>
            </td>
            <td>is the number of periods in the depreciation period</td>
        </tr>
        <tr>
            <td class="csg-function-parameter">period</td>
            <td>is the year of the life for which you wish to calculate the depreciation allowance</td>
        </tr>
    </table>
    <h5>Example:</h5>
    <p>
        You purchase a &pound;500 computer that has a salvage value of &pound;100 after five years.
        The depreciation allowance for the first year is given by the formula
        <code>SYD(500,100,5,1)</code> which returns &pound;133.33.
    </p>

    <h2 class="csg-function" id="TERM">TERM</h2>
    <p>Computes how many periods it will take regular equal payments at a fixed periodic interest rate to reach a future value.</p>
    <h5>Syntax:</h5>
    <p class="csg-function-declaration">
        TERM(<span class="csg-function-parameter">payment</span>,
        <span class="csg-function-parameter">interest</span>,
        <span class="csg-function-parameter">future_value&nbsp;</span>)
    </p>
    <table>
        <tr>
            <td class="csg-function-parameter">payment</td>
            <td>The regular payment made each period</td>
        </tr>
        <tr>
            <td class="csg-function-parameter">interest</td>
            <td>The interest rate received</td>
        </tr>
        <tr>
            <td class="csg-function-parameter">future_value&nbsp;</td>
            <td>The future value you want to achieve</td>
        </tr>
    </table>
    <p>The following formula is used to calculate the term:</p>
    <p class="csg-function-formula">term = <i>ln</i>(1 + (<i>future_value</i> &times; <i>interest</i> &divide; <i>payment</i>)) &divide; <i>ln</i>(1 + <i>interest</i>)</p>
    <h5>Example:</h5>
    <p>
        Given that you can invest &pound;5000 a year into a pension fund, at 10% annual interest, how long will it take to accumulate &pound;1,000,000?
        The formula <code>TERM(5000,0.10,1000000)</code> returns the answer, 31.94 years.
    </p>

    <div class="navfooter">
        <table id="navfooter" summary="Navigation footer">
            <tr>
                <td id="navfooter_PUN_L">File Operations </td>
                <td id="navfooter_PUN_C"></td>
                <td id="navfooter_PUN_R"> First Word Plus</td>
            </tr>
            <tr>
                <td id="navfooter_PUN_L"><a accesskey="p" href="fileops.html">Prev</a> </td>
                <td id="navfooter_PUN_C"><a accesskey="h" href="../index.html">Home</a></td>
                <td id="navfooter_PUN_R"> <a accesskey="n" href="firstwordplus.html">Next</a></td>
            </tr>
        </table>
    </div>
</body>
</html>
