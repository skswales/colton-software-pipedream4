<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="content-type" content="text/html; charset=iso-8859-1" />
  <title>Database Use</title>
  <meta name="generator" content="Amaya, see http://www.w3.org/Amaya/" />
  <link href="csguide.css" rel="stylesheet" type="text/css" />
  <style type="text/css">
 .transpose-example-column-width { width: 192px;} </style>
</head>

<body>
<!-- This Source Code Form is subject to the terms of the Mozilla Public
   - License, v. 2.0. If a copy of the MPL was not distributed with this
   - file, You can obtain one at http://mozilla.org/MPL/2.0/. -->
<!-- Copyright (C) 1991-1998 Colton Software Limited
   - Copyright (C) 1998-2014 R W Colton -->
<div class="navheader">
<table width="100%" summary="Navigation header">
<tr>
<td width="20%" align="left"><a accesskey="p" href="databasefns.html">Prev</a> </td>
<th width="60%" align="center">PipeDream 4 Reference Guide</th>
<td width="20%" align="right"> <a accesskey="n" href="datetime.html">Next</a></td>
</tr>
</table>
<hr/>
</div>

<h1>Database Use</h1>

<p>You can use PipeDream to store a database of records. PipeDream provides
facilities to sort your records on one or more fields. You can save out only
those records which satisfy one or more conditions which you specify or those
records which satisfy one of several specified conditions. PipeDream also
provides several database functions which enable you to manipulate your records
in various ways.</p>

<h2>Entering Records</h2>

<p>You can enter records in two different ways:</p>
<ul>
  <li>As single rows</li>
  <li>As multi-row records</li>
</ul>

<h2>Single-Row Records</h2>

<p>Each record takes up just one row in the file. On sorting, each row is
considered as a separate record. Most databases have single row records.</p>

<p>If you have entered some names and addresses like this:</p>

<table border="1" class="csguide-sample">
  <col />
  <tbody>
    <tr>
      <td class="transpose-example-column-width">Mr. R.T. Smith.</td>
    </tr>
    <tr>
      <td>3, The Drive,</td>
    </tr>
    <tr>
      <td>Tonbridge,</td>
    </tr>
    <tr>
      <td>Kent.</td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td>Mr &amp; Mrs. G. Fox</td>
    </tr>
    <tr>
      <td>192b High Street</td>
    </tr>
    <tr>
      <td>Cambridge,</td>
    </tr>
    <tr>
      <td>Cambs.</td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td>Mr. J. FitzHenry</td>
    </tr>
    <tr>
      <td>"RiverView",</td>
    </tr>
    <tr>
      <td>Sevenoaks,</td>
    </tr>
    <tr>
      <td>Kent.</td>
    </tr>
  </tbody>
</table>



<p>and then realise that you actually wanted to enter them as single-row
records like this:</p>

<table border="1" class="csguide-sample">
  <col />
  <col />
  <col />
  <col />
  <tbody>
    <tr>
      <td class="transpose-example-column-width">Mr. R.T. Smith.</td>
      <td class="transpose-example-column-width">3, The Drive,</td>
      <td class="transpose-example-column-width">Tonbridge,</td>
      <td class="transpose-example-column-width">Kent.</td>
    </tr>
    <tr>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td>Mr &amp; Mrs. G. Fox</td>
      <td>192b High Street</td>
      <td>Cambridge,</td>
      <td>Cambs.</td>
    </tr>
    <tr>
      <td></td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td>Mr. J. FitzHenry</td>
      <td>"RiverView",</td>
      <td>Sevenoaks,</td>
      <td>Kent.</td>
    </tr>
  </tbody>
</table>



<p>all you have to do is mark each name and address like this:</p>

<table border="1" class="csguide-sample">
  <col />
  <col />
  <col />
  <col />
  <tbody>
    <tr>
      <td class="transpose-example-column-width">Mr. R.T. Smith.</td>
      <td class="transpose-example-column-width">3, The Drive,</td>
      <td class="transpose-example-column-width">Tonbridge,</td>
      <td class="transpose-example-column-width">Kent.</td>
    </tr>
    <tr>
      <td>&nbsp;</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <td style="color:#ffffff;background-color:#400040">Mr &amp; Mrs. G.
      Fox</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <td style="color:#ffffff;background-color:#400040">192b High Street</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <td style="color:#ffffff;background-color:#400040">Cambridge,</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <td style="color:#ffffff;background-color:#400040">Cambs.</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <td>&nbsp;</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <td>Mr. J. FitzHenry</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <td>"RiverView",</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <td>Sevenoaks,</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <td>Kent.</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>



<p>and give the <span class="csguide-command">Transpose Blocks</span>
command:</p>

<table class="csguide-command-table">
  <col />
  <col />
  <col />
  <col />
  <tbody>
    <tr>
      <th class="csgcth-menu">Menu</th>
      <th class="csgcth-command">Command</th>
      <th class="csgcth-ctrl">Ctrl-sequence</th>
      <th class="csgcth-key">Key</th>
    </tr>
    <tr>
      <td>Blocks</td>
      <td>Transpose blocks</td>
      <td><span class="csguide-key">BD</span></td>
      <td></td>
    </tr>
  </tbody>
</table>

<h3>Sorting Single-Row Records</h3>

<p>You can sort the records in your database on any column, in either ascending
order or descending order. You can also sort on several columns, one after the
other in the order you specify. If sorting on several columns, you can specify
ascending or descending order separately for each column.</p>

<p>Text cells and strings are sorted alphabetically, number cells in numerical
order of their value and dates in date order.</p>

<p>1. Mark the block of cells you want to sort. If you want to sort the whole
document, click Select in the mark block box to mark the whole document.</p>

<p>2. Give the <span class="csguide-command">Sort</span> command:</p>

<table class="csguide-command-table">
  <col />
  <col />
  <col />
  <col />
  <tbody>
    <tr>
      <th class="csgcth-menu">Menu</th>
      <th class="csgcth-command">Command</th>
      <th class="csgcth-ctrl">Ctrl-sequence</th>
      <th class="csgcth-key">Key</th>
    </tr>
    <tr>
      <td>Blocks</td>
      <td>Sort</td>
      <td><span class="csguide-key">BSO</span></td>
      <td></td>
    </tr>
  </tbody>
</table>

<p>3. When the dialogue box appears, type in the column or columns you want to
be sorted. PipeDream supplies the column containing the caret as a default.</p>

<p>By default, the sort will be in ascending order. This means that the
smallest item will be put first and the largest at the bottom. To reverse this,
click Select on the <span class="csguide-option">Ascending order</span> option
to turn it off.</p>

<p>You can set this option for each column you type in. If you do not type in a
column reference, the sort will take place on the column containing the caret.
Note that part of or all of the column must be within the marked block.</p>

<h2>Multi-Row Records</h2>

<p>Databases can be built which have records containing paragraphs of text. A
record in the database can be one row or it may be more than one row.</p>

<p>Note that you can sort multi-row records but you cannot do row selections or
mailshots with them as these two operations assume that each row is a separate
record. For this reason, it is usually best to have your databases comprising
just single row records.</p>

<h3>Sorting Multi-Row Records</h3>

<p>If you want to be able to sort records consisting of more than one line, you
need to enter your records in the following way:</p>

<div class="csguide-sample">

<table border="1">
  <col />
  <col />
  <col />
  <tbody>
    <tr class="csguide-border-colhead">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
    <tr>
      <th class="csguide-border-rowhead">1</th>
      <td>British Blue</td>
      <td>The British Blue has a sturdy body and shortish</td>
    </tr>
    <tr>
      <th class="csguide-border-rowhead">2</th>
      <td></td>
      <td>legs. Its fur is thick and short and an even</td>
    </tr>
    <tr>
      <th class="csguide-border-rowhead">3</th>
      <td></td>
      <td>grey colour. Its eyes are deep red copper. It is</td>
    </tr>
    <tr>
      <th class="csguide-border-rowhead">4</th>
      <td></td>
      <td>usually friendly with everybody.</td>
    </tr>
    <tr>
      <th class="csguide-border-rowhead">5</th>
      <td>Seal Point Siamese</td>
      <td>The Seal Point Siamese has dark brown 'points'</td>
    </tr>
    <tr>
      <th class="csguide-border-rowhead">6</th>
      <td></td>
      <td>- ears, mask, legs and tail, contrasting with a</td>
    </tr>
    <tr>
      <th class="csguide-border-rowhead">7</th>
      <td></td>
      <td>cream body. Its fur is smooth and silky. Its</td>
    </tr>
    <tr>
      <th class="csguide-border-rowhead">8</th>
      <td></td>
      <td>eyes should be china blue. It is very friendly</td>
    </tr>
    <tr>
      <th class="csguide-border-rowhead">9</th>
      <td></td>
      <td>and rather noisy.</td>
    </tr>
    <tr>
      <th class="csguide-border-rowhead">10</th>
      <td>Brown Tabby Persian</td>
      <td>The Brown Tabby Persian has the typical flat</td>
    </tr>
    <tr>
      <th class="csguide-border-rowhead">11</th>
      <td></td>
      <td>Persian Face, with golden eyes. Its long, thick</td>
    </tr>
    <tr>
      <th class="csguide-border-rowhead">12</th>
      <td></td>
      <td>fur has even tabby markings with a cream chin</td>
    </tr>
    <tr>
      <th class="csguide-border-rowhead">13</th>
      <td></td>
      <td>and black 'slippers'. It can be rather timid</td>
    </tr>
    <tr>
      <th class="csguide-border-rowhead">14</th>
      <td></td>
      <td>but is very friendly with those it
      trusts.</td>
    </tr>
  </tbody>
</table>
</div>

<p>When you sort such records, you must have the <span
class="csguide-option">Multi-row records</span> option in the <span
class="csguide-dbox">Sort</span> dialogue box turned on. The blank cells
between the multi-row records ensure that when you sort the records on column
A, all the rows in the record will be kept together. So, you can specify a sort
on column A to get the cats in alphabetical order. The result would be as
follows:</p>

<div class="csguide-sample">

<table border="1">
  <col />
  <col />
  <col />
  <tbody>
    <tr class="csguide-border-colhead">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
    <tr>
      <th class="csguide-border-rowhead">1</th>
      <td>British Blue</td>
      <td>The British Blue has a sturdy body and shortish</td>
    </tr>
    <tr>
      <th class="csguide-border-rowhead">2</th>
      <td></td>
      <td>legs. Its fur is thick and short and an even</td>
    </tr>
    <tr>
      <th class="csguide-border-rowhead">3</th>
      <td></td>
      <td>grey colour. Its eyes are deep red copper. It is</td>
    </tr>
    <tr>
      <th class="csguide-border-rowhead">4</th>
      <td></td>
      <td>usually friendly with everybody.</td>
    </tr>
    <tr>
      <th class="csguide-border-rowhead">5</th>
      <td>Brown Tabby Persian</td>
      <td>The Brown Tabby Persian has the typical flat</td>
    </tr>
    <tr>
      <th class="csguide-border-rowhead">6</th>
      <td></td>
      <td>Persian Face, with golden eyes. Its long, thick</td>
    </tr>
    <tr>
      <th class="csguide-border-rowhead">7</th>
      <td></td>
      <td>fur has even tabby markings with a cream chin</td>
    </tr>
    <tr>
      <th class="csguide-border-rowhead">8</th>
      <td></td>
      <td>and black 'slippers'. It can be rather timid</td>
    </tr>
    <tr>
      <th class="csguide-border-rowhead">9</th>
      <td></td>
      <td>but is very friendly with those it trusts.</td>
    </tr>
    <tr>
      <th class="csguide-border-rowhead">10</th>
      <td>Seal Point Siamese</td>
      <td>The Seal Point Siamese has dark brown 'points'</td>
    </tr>
    <tr>
      <th class="csguide-border-rowhead">11</th>
      <td></td>
      <td>- ears, mask, legs and tail, contrasting with a</td>
    </tr>
    <tr>
      <th class="csguide-border-rowhead">12</th>
      <td></td>
      <td>cream body. Its fur is smooth and silky. Its</td>
    </tr>
    <tr>
      <th class="csguide-border-rowhead">13</th>
      <td></td>
      <td>eyes should be china blue. It is very friendly</td>
    </tr>
    <tr>
      <th class="csguide-border-rowhead">14</th>
      <td></td>
      <td>and rather noisy.</td>
    </tr>
  </tbody>
</table>
</div>

<h2>Saving Selected Records From Your Database</h2>

<p>You can save to a file those records which satisfy one or more conditions
you specify, such as all the cars in your database which are both red and have
five doors. You can save all those records which satisfy one of several
conditions you specify, such as all the cars in your database which are
manufactured either in Germany or in France.</p>

<p>1. Give the <span class="csguide-command">Save</span> command.</p>

<p>2. When the dialogue box appears, click Select on the <span
class="csguide-option">Save selection of rows</span> option.</p>

<p>3. Type in the condition you want to apply.</p>

<p>The formula you type in will be evaluated before each row (record) is saved.
Only if the result is true will the row be saved. The formula will normally
contain cell references. These are updated one row for each new line.</p>

<p>For example, if you enter <code>B1B100&gt;100</code> as the condition, all
rows where the second column evaluates to a number greater than 100 will be
saved. On row 1, the condition will be <code>B1&gt;100</code>. On row 2, the
condition will change to <code>B2&gt;100</code>, on row 3 to
<code>B3&gt;100</code>, on row 4 to <code>B4&gt;100</code>, etc.</p>

<p>You can include text strings in the condition, but they must be placed
within double quotation marks.</p>

<p>For example, the condition <code>A1A100&gt;"Fred"</code> will save all lines
lying alphabetically after Fred, such as <code>"Tom"</code> and
<code>"Harry"</code> but not <code>"Dick"</code>.</p>

<p>A string can contain the wildcards <code>^?</code> (any single character)
and <code>^#</code> (any multiple character). All string comparisons treat
lower and upper case letters as the same.</p>

<p>You can save rows which satisfy more than one condition by using the
<code>&amp;</code> operator.</p>

<p>For example (here we are just showing the first ten rows of a 100 row
database):</p>

<div class="csguide-sample">

<table border="1">
  <col />
  <col />
  <col />
  <col />
  <tbody>
    <tr class="csguide-border-colhead">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
    <tr>
      <th class="csguide-border-rowhead">1</th>
      <td>A. Jones</td>
      <td>Weymouth</td>
      <td>Ford Fiesta</td>
    </tr>
    <tr>
      <th class="csguide-border-rowhead">2</th>
      <td>B. Smith</td>
      <td>Cambridge</td>
      <td>VW Polo</td>
    </tr>
    <tr>
      <th class="csguide-border-rowhead">3</th>
      <td>C. Thompson</td>
      <td>Lancaster</td>
      <td>Vauxhall Cavalier</td>
    </tr>
    <tr>
      <th class="csguide-border-rowhead">4</th>
      <td>D. Reed</td>
      <td>Weymouth</td>
      <td>Citroen BX</td>
    </tr>
    <tr>
      <th class="csguide-border-rowhead">5</th>
      <td>E. Baker</td>
      <td>Halifax</td>
      <td>VW Golf</td>
    </tr>
    <tr>
      <th class="csguide-border-rowhead">6</th>
      <td>F. Baxter</td>
      <td>Cambridge</td>
      <td>Citroen BX</td>
    </tr>
    <tr>
      <th class="csguide-border-rowhead">7</th>
      <td>G. Parker</td>
      <td>Cambridge</td>
      <td>VW Golf</td>
    </tr>
    <tr>
      <th class="csguide-border-rowhead">8</th>
      <td>H. Walker</td>
      <td>Norwich</td>
      <td>Ford Fiesta</td>
    </tr>
    <tr>
      <th class="csguide-border-rowhead">9</th>
      <td>I. Potter</td>
      <td>Cambridge</td>
      <td>VW Golf</td>
    </tr>
    <tr>
      <th class="csguide-border-rowhead">10</th>
      <td>J. Brown</td>
      <td>Cambridge</td>
      <td>VW Passat</td>
    </tr>
  </tbody>
</table>
</div>

<p>To save all those who live in Cambridge and drive VW Golfs, you would type
in:</p>

<p style="margin-left:2em;"><code>B1B100="Cambridge" &amp; C1C100="VW
Golf"</code></p>

<p>To save all those who live in Cambridge and drive any type of VW, you would
type in:</p>

<p style="margin-left:2em;"><code>B1B100="Cambridge" &amp;
C1C100="VW^#"</code></p>

<p>You can also use the <code>|</code> (vertical bar) operator to save those
rows which satisfy one of a number of conditions.</p>

<p>Still using the above example database, to save those who either live in
Weymouth or drive a Citroen BX, you would type in:</p>

<p style="margin-left:2em;"><code>B1B100="Weymouth" | C1C100="Citroen
BX"</code></p>



<div class="navfooter">
<hr/>
<table width="100%" summary="Navigation footer">
<tr>
<td width="40%" align="left"><a accesskey="p" href="databasefns.html">Prev</a> </td>
<td width="20%" align="center"></td>
<td width="40%" align="right"> <a accesskey="n" href="datetime.html">Next</a></td>
</tr>
<tr>
<td width="40%" align="left" valign="top">Database Functions </td>
<td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td>
<td width="40%" align="right" valign="top"> Dates and Times</td>
</tr>
</table>
</div>
</body>
</html>
