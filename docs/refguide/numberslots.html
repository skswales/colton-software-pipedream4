<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="content-type" content="text/html; charset=iso-8859-1" />
  <title>Number Slots</title>
  <meta name="generator" content="Amaya, see http://www.w3.org/Amaya/" />
  <link href="csguide.css" rel="stylesheet" type="text/css" />
</head>

<body>
<!-- This Source Code Form is subject to the terms of the Mozilla Public
   - License, v. 2.0. If a copy of the MPL was not distributed with this
   - file, You can obtain one at http://mozilla.org/MPL/2.0/. -->
<!-- Copyright (C) 1991-1998 Colton Software Limited
   - Copyright (C) 1998-2014 R W Colton -->
<div class="navheader">
<table width="100%" summary="Navigation header">
<tr>
<td width="20%" align="left"><a accesskey="p" href="numberformats.html">Prev</a> </td>
<th width="60%" align="center">PipeDream 4 Reference Guide</th>
<td width="20%" align="right"> <a accesskey="n" href="options.html">Next</a></td>
</tr>
</table>
<hr/>
</div>

<h1>Number Slots</h1>

<p>Number slots enable you to perform calculations automatically and to display
the result in the document. You can use number slots to perform one or two
calculations within a text document. Or, by creating a table of number slots,
you can build a large spreadsheet to perform a complete business plan,
accounting application, or project forecast. This section first describes how
to create number slots. Then it describes the operations available in the
formulae entered into number slots, which can include arithmetic between
numbers, references to other slots, and a selection of useful functions for
working with numbers. You can alter the format in which numbers are displayed
and you can make the value of a number slot appear in the middle of a line of
text. Finally, you can transfer values between documents.</p>

<h2>Formulae</h2>

<p>You can enter a wide range of mathematical formulae into number slots.
Formulae can contain numbers, dates, text strings, conditions, arithmetic
operators, functions and references to other slots. Number slots display the
result of evaluating the formula rather than the formula itself.</p>

<h2>Editing Number Slots</h2>

<p>If you want to create a large number of number slots, when building a
spreadsheet for example, it is a good idea to set the <span
class="csguide-option">New slot format</span> option in the <span
class="csguide-dbox">Options</span> dialogue box to <span
class="csguide-option">Numbers</span>.</p>

<p>If you require number slots within text, you can create number slots
individually.</p>

<p>To start editing a number slot, click Select in the formula line (this is at
the top of the toolbar).</p>

<p>Clicking Select in the formula line has the following effects:</p>

<p>1. Any slot contents are displayed in the formula line (or, if the slot
contents consist of more than one line, in the formula window).</p>

<p>2. The <span class="csguide-toolbar-button">tick</span> icon and the <span
class="csguide-toolbar-button">cross</span> icon become active.</p>

<p>3. The caret moves to the formula line (or formula window) so that you can
enter or edit a formula.</p>

<p>Giving the <span class="csguide-command">Edit Formula</span> command has the
same effects:</p>

<table class="csguide-command-table">
  <col />
  <col />
  <col />
  <col />
  <tbody>
    <tr>
      <th class="csgcth-menu">Menu</th>
      <th class="csgcth-command">Command</th>
      <th class="csgcth-ctrl">Ctrl-sequence</th>
      <th class="csgcth-key">Key</th>
    </tr>
    <tr>
      <td>Edit</td>
      <td>Edit formula</td>
      <td><span class="csguide-key">X</span></td>
      <td><span class="csguide-key">F2</span></td>
    </tr>
  </tbody>
</table>

<p>To enter the coordinates of any slot into the formula line or formula
window, click Select in the slot.</p>

<p>For example, if you click Select in slot A4, <code>A4</code> will appear on
the formula line.</p>

<p>You can also click Select in a slot in another document to insert its
reference into the formula line of the document you are editing.</p>

<p>You can click Select or Adjust to position the caret at a point in the
formula line or formula window.</p>

<p>You can use the following keys to edit the number in the formula line or
formula window:</p>

<table border="0">
  <col />
  <col />
  <tbody>
    <tr>
      <td><span class="csguide-key">Delete</span> &nbsp;or&nbsp; <span class="csguide-key">&#x21a4;</span></td>
      <td>Deletes the character to the left of the caret</td>
    </tr>
    <tr>
      <td><span class="csguide-key">Copy</span></td>
      <td>Deletes the character to the right of the caret</td>
    </tr>
    <tr>
      <td><span class="csguide-key">&rarr;</span></td>
      <td>Moves the caret one character to the right</td>
    </tr>
    <tr>
      <td><span class="csguide-key">&larr;</span></td>
      <td>Moves the caret one character to the left</td>
    </tr>
    <tr>
      <td><span class="csguide-key">Shift-&rarr;</span></td>
      <td>Moves the caret left one word</td>
    </tr>
    <tr>
      <td><span class="csguide-key">Shift-&larr;</span></td>
      <td>Moves the caret right one word</td>
    </tr>
    <tr>
      <td><span class="csguide-key">Ctrl-Copy</span></td>
      <td>Deletes forward to the end of the line</td>
    </tr>
    <tr>
      <td><span class="csguide-key">Ctrl-U</span></td>
      <td>Deletes the whole formula</td>
    </tr>
    <tr>
      <td><span class="csguide-key">Ctrl-&larr;</span></td>
      <td>Moves the caret to the beginning of the line</td>
    </tr>
    <tr>
      <td><span class="csguide-key">Ctrl-&rarr;</span></td>
      <td>Moves the caret to the end of the line</td>
    </tr>
    <tr>
      <td><span class="csguide-key">Ctrl-Enter&nbsp;&nbsp;</span></td>
      <td>Enters a newline into the formula in the formula window</td>
    </tr>
  </tbody>
</table>

<p>To enter the formula you have typed on the formula line or in the formula
window into the document, press <span class="csguide-key">Enter</span> or click Select on the tick
icon. Alternatively, you can press <span
class="csguide-key">&darr;</span> to enter the formula and
automatically move down to the next slot. Alternatively, you can abandon
editing and leave the slot unchanged by pressing the <span
class="csguide-key">Esc</span> key or clicking
Select on the cross icon.</p>

<p>If you want to create a new number slot containing a formula consisting of
more than one line, you can press <span class="csguide-key">Ctrl-EFW</span> or click Select on the PipeDream 4
icon to open the formula window. A window appears on the screen into which you
type your slot contents. You can use the keys listed above for editing the
contents of the formula window.</p>

<p>You can also mark and delete blocks within the formula window. To mark a
block, position the caret where you want the marking to start and drag Select
until the block is marked. Pressing <span class="csguide-key">Delete</span> or
<span class="csguide-key">&#x21a4;</span> will delete the marked block. To extend the marked block,
position the caret at the point to which you want to extend and click Adjust.
If you have a block marked, anything you type will replace the marked block and
repositioning the caret will clear the marked block.</p>

<p>In the formula window or formula line, you can insert spaces into your
formulae to make them more readable. Note that in the formula window you need
to press <span class="csguide-key">Ctrl-Enter</span> to start a new line; pressing
<span class="csguide-key">Enter</span> has the same effect as clicking the
<span class="csguide-toolbar-button">tick</span> button.</p>

<p>You can paste functions into the formula line or the formula window without
having to type them in. Position the caret in the slot in which you want the
function to be inserted. Move the pointer onto the <span
class="csguide-toolbar-button">Function</span> button. The pointer's shape will
change. When you click Select, you will see the <span
class="csguide-menu">Function</span> menu which lists the
various types of PipeDream functions. Slide off the type of function you want.
You will see a list of functions. Click Select on the function you want. It
will be inserted into the formula line or the formula window at the caret
position.</p>

<p>If you are typing a formula into the formula line and decide to use the
formula window instead, you can press <span
class="csguide-key">Ctrl-Enter</span> to transfer the
contents of the formula line into the formula window.</p>

<p>Formulae may be composed of the following elements, defined below:</p>

<table border="0">
  <col />
  <col />
  <tbody>
    <tr>
      <td><strong>Element</strong></td>
      <td><strong>Example<br />
        </strong></td>
    </tr>
    <tr style="vertical-align: top;">
      <td>Arrays</td>
      <td><code>{1,2,3}<br />
        </code></td>
    </tr>
    <tr style="vertical-align: top;">
      <td>Dates</td>
      <td><code>5.9.87<br />
        6.10.1066<br />
        </code></td>
    </tr>
    <tr style="vertical-align: top;">
      <td>Functions</td>
      <td><code>SIN(3/2)<br />
        </code></td>
    </tr>
    <tr style="vertical-align: top;">
      <td>Lists</td>
      <td><code>1,4,6,9<br />
        1,2,3,{4,5,6},A1A10<br />
        </code></td>
    </tr>
    <tr style="vertical-align: top;">
      <td>Names</td>
      <td><code>Fred<br />
        Arg_1<br />
        </code></td>
    </tr>
    <tr style="vertical-align: top;">
      <td>Numbers</td>
      <td><code>2<br />
        </code></td>
    </tr>
    <tr style="vertical-align: top;">
      <td>Operators</td>
      <td><code>+<br />
        </code></td>
    </tr>
    <tr style="vertical-align: top;">
      <td>Slot references&nbsp;&nbsp;</td>
      <td><code>A23<br />
        [Fred]E17<br />
        [ADFS:$.Addresses.Schools]F12<br />
        [MyData:Database]B4<br />
        <br />
        </code></td>
    </tr>
    <tr style="vertical-align: top;">
      <td>Ranges</td>
      <td><code>A1W70<br />
        [Totals]A1E100<br />
        </code></td>
    </tr>
    <tr style="vertical-align: top;">
      <td>Strings</td>
      <td><code>"January"<br />
        </code></td>
    </tr>
    <tr style="vertical-align: top;">
      <td>Times</td>
      <td><code>19:30<br />
        18:56:04</code></td>
    </tr>
  </tbody>
</table>

<h2>Arrays</h2>

<p>An array is a group of items within one slot. Arrays consist of columns and
rows of data.</p>

<p>Enter an array by enclosing the array contents in curly brackets. Data in
the same row in an array is separated by commas; rows in the array are
separated by semi-colons.</p>

<p>Arrays can contain numbers, dates, strings, names or slot references.</p>

<p>Arrays cannot contain ranges or other arrays.</p>

<p>You can mix different types of data in the same array.</p>

<h2>Dates and Times</h2>

<p>Dates can be displayed in English, American or textual format, which is
specified in the <span class="csguide-dbox">Options</span> dialogue box. If
the option is set to <span class="csguide-option">Text</span>, you must enter
the date in English format.</p>

<p>1. English format:<code>&nbsp;&nbsp;day.month.year</code></p>

<p>For example:</p>

<p style="margin-left:2em;"><code>30.4.91</code></p>

<p>2. American format:<code>&nbsp;&nbsp;month.day.year</code></p>

<p>For example:</p>

<p style="margin-left:2em;"><code>4.30.91</code></p>

<p>3. Textual format:<code>&nbsp;&nbsp;day.month.year</code></p>

<p>For example:</p>

<p style="margin-left:2em;"><code>30 Apr 1991&nbsp;&nbsp;&nbsp;</code> in a number slot or</p>

<p style="margin-left:2em;"><code>30 April 1991&nbsp;</code> in a text slot</p>

<p>Dates and times can be sorted into chronological order, and functions exist
to manipulate time and date values. The function TODAY returns the current
date.</p>

<p>Dates run from year 100 AD onwards. Dates less than 100 are assumed to be
relative to the current century. For example, if you enter 1.1.91, PipeDream
treats this as 1.1.1991 and displays it thus. If you enter 1.1.100, PipeDream
treats this as 1.1.100; 1.1.1756 will be treated by PipeDream as 1.1.1756.</p>

<p>Times run from midnight each day. Enter times in the format 6:30 or 19:20.
Seconds are optional, for example 18:20:30.</p>

<p>You can enter a combined date and time in the form</p>

<p style="margin-left:2em;"><code>1.6.91 6:30</code></p>

<h2>Functions</h2>

<p>Functions perform an operation upon the parameters which follow them and
return a result.</p>

<p>For example,</p>

<p style="margin-left:2em;"><code>INT(A1)</code> </p>

<p>returns the integer part of A1.</p>

<h2>Lists</h2>

<p>Certain functions can take a list of elements, separated by commas. Ranges
and arrays can be included among the list elements, in which case each element
in the range or array is considered as a separate list element.</p>

<p>For example,</p>

<p style="margin-left:2em;"><code>1, A1A5, -2</code></p>

<p>is a list containing 7 elements (not 3), because the range A1A5 contains 5
slots.</p>

<h2>Names</h2>

<p>Names can be defined to refer to data items - slots, constants, ranges or
arrays. Then, instead of using the data item itself in formulae, you can use
the name, which is probably easier to remember. If you want to change the value
of the data item, changing the name is probably easier than finding all the
places where you have used the data item.</p>

<p>Names are saved and loaded with the spreadsheet on which they were defined.
Names can refer to data items on another spreadsheet.</p>

<p>You define, alter and insert names using the <span
class="csguide-menu-option">Names</span> option on the <span
class="csguide-menu">Function</span> menu obtained by
clicking Select on the <span class="csguide-toolbar-button">Function</span> button.</p>

<p>Names can be up to 24 characters long.</p>

<p>The characters a-z and _ (underscore) are allowed in names. The digits 0-9
are only allowed after the _ character.</p>

<p>For example:</p>

<p>Valid Names are:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<code>Apple&nbsp;&nbsp;&nbsp;box_1&nbsp;&nbsp;&nbsp;x</code></p>

<p>Invalid Names are:&nbsp;&nbsp;&nbsp;<code>a1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;red63</code></p>

<p>In both these invalid cases, there is a digit which is not preceded by an
underscore character.</p>

<h2>Numbers</h2>

<p>Exponential format can be used. All calculations are performed to an
accuracy of 15 figures.</p>

<p>For example:</p>

<p style="margin-left:2em;"><code>1</code></p>

<p style="margin-left:2em;"><code>-1.76576</code></p>

<p style="margin-left:2em;"><code>1.4e3</code></p>

<p style="margin-left:2em;"><code>0.1</code></p>

<h2>Operators</h2>

<p>Brackets can be included in formulae.</p>

<h3>Arithmetic</h3>

<p>The arithmetic operators take two numbers as operands.</p>

<p><code>+&nbsp;&nbsp;&nbsp;</code>add</p>

<p><code>-&nbsp;&nbsp;&nbsp;</code>subtract</p>

<p><code>*&nbsp;&nbsp;&nbsp;</code>multiply</p>

<p><code>/&nbsp;&nbsp;&nbsp;</code>divide</p>

<p><code>^&nbsp;&nbsp;&nbsp;</code>raise to the power</p>

<h3>Logical</h3>

<p>The logical operators operate on numeric or logical values.</p>

<p>Boolean FALSE is taken as zero, TRUE as non-zero.</p>

<p>A true condition returns the value TRUE (1).</p>

<p><code>&amp;&nbsp;&nbsp;&nbsp;</code>AND</p>

<p><code>|&nbsp;&nbsp;&nbsp;</code>OR</p>

<p><code>!&nbsp;&nbsp;&nbsp;</code>unary NOT</p>

<p>Note that if the left hand side of an AND expression evaluates to FALSE, the
right hand side is not evaluated.</p>

<p>If the left hand side of an OR expression evaluates to TRUE, the right hand
side is not evaluated.</p>

<h3>Relational</h3>

<p>The relational operators can compare dates, strings, and numbers.</p>

<p>Both operands must be of the same type.</p>

<p>The result is a Boolean value of FALSE (0) or TRUE (1).</p>

<p><code>&lt;&nbsp;&nbsp;&nbsp;</code>less than</p>

<p><code>&lt;=&nbsp;&nbsp;</code>less than or equal to</p>

<p><code>&lt;&gt;&nbsp;&nbsp;</code>not equal to</p>

<p><code>=&nbsp;&nbsp;&nbsp;</code>equal to</p>

<p><code>&gt;&nbsp;&nbsp;&nbsp;</code>greater than</p>

<p><code>&gt;=&nbsp;&nbsp;</code>greater than or equal to</p>

<p>When strings are being compared, the following wildcards are allowed in the
second string:</p>

<p><code>^?&nbsp;&nbsp;</code>matches any single character not including space</p>

<p><code>^#&nbsp;&nbsp;</code>matches any number of characters</p>

<p><code>^^&nbsp;&nbsp;</code>represents ^</p>

<p>For example, if slot A1 contains <code>Macmillan</code>, then</p>

<p style="margin-left:2em;"><code>A1="M^#cmillan"&nbsp;</code>has value 1 (TRUE),</p>

<p style="margin-left:2em;"><code>A1="Mc^#"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>has value 0
(FALSE),</p>

<p style="margin-left:2em;"><code>A1="^?^?c^#"&nbsp;&nbsp;&nbsp;&nbsp;</code>has value 1 (TRUE).</p>

<p>The order of precedence for the operators mentioned above is:</p>

<table border="0">
  <col />
  <col />
  <col />
  <tbody>
    <tr style="vertical-align: top;">
      <td>Group 1</td>
      <td style="padding-bottom: 4px;"><code>-<br />
        ()<br />
        !<br />
        </code></td>
      <td>Unary minus<br />
        Brackets<br />
        Unary NOT</td>
    </tr>
    <tr style="vertical-align: top;">
      <td>Group 2</td>
      <td style="padding-bottom: 4px;"><code>^<br />
        </code></td>
      <td>Raise to power</td>
    </tr>
    <tr style="vertical-align: top;">
      <td>Group 3</td>
      <td style="padding-bottom: 4px;"><code>*<br />
        /<br />
        </code></td>
      <td>Multiply<br />
        Divide</td>
    </tr>
    <tr style="vertical-align: top;">
      <td>Group 4</td>
      <td style="padding-bottom: 4px;"><code>+<br />
        -<br />
        </code></td>
      <td>Plus<br />
        Minus</td>
    </tr>
    <tr style="vertical-align: top;">
      <td>Group 5&nbsp;&nbsp;</td>
      <td style="padding-bottom: 4px;"><code>=<br />
        &lt;&gt;<br />
        &lt;<br />
        &gt;<br />
        &lt;=<br />
        &gt;=&nbsp;&nbsp;<br />
        </code></td>
      <td>Equals<br />
        Not equal to<br />
        Less than<br />
        Greater than<br />
        Not greater than<br />
        Not less than</td>
    </tr>
    <tr style="vertical-align: top;">
      <td>Group 6</td>
      <td style="padding-bottom: 4px;"><code>&amp;<br />
        </code></td>
      <td>AND</td>
    </tr>
    <tr style="vertical-align: top;">
      <td>Group 7</td>
      <td><code>|</code></td>
      <td>OR</td>
    </tr>
  </tbody>
</table>

<h2>Ranges</h2>

<p>Certain functions can operate on a block of slots, specified by a range
descriptor of the form <code>slot_ref1</code><span style="font-size: 4pt">
</span><code>slot_ref2</code>, where <code>slot_ref1</code> (see Slot
References) specifies the top left-hand corner of the block, and
<code>slot_ref2</code> specifies the bottom right-hand corner of the block.</p>

<p>The slots referred to can be in another document, providing you put
<code>[filename]</code> first, where <em>filename</em> is the name of the
document containing the slots being referred to.</p>

<p>As with slot references, ranges are normally 'relative' which means that, if
the range is replicated or copied from one slot to another, the difference in
position between the two slots will be added on to or subtracted from the
range. Each half of either slot reference in the range may be 'fixed' (made
'absolute') by preceding the column letter or the row number by a dollar ($)
sign (see Slot References).</p>

<p>For example:</p>

<p style="margin-left:2em;"><code>A1A100</code></p>

<p style="margin-left:2em;"><code>A1A1</code></p>

<p style="margin-left:2em;"><code>[fred]B2C3</code></p>

<p style="margin-left:2em;"><code>AC6AD10</code></p>

<p style="margin-left:2em;"><code>Q$5R$6</code></p>

<h2>Slot References</h2>

<p>The form of a slot reference is <code>column_label</code><span
style="font-size: 4pt"> </span><code>row_number</code> where
<code>column_label</code> designates a column, <code>A</code> to
<code>Z</code>, <code>AA</code> to <code>ZZ</code>, <code>AAA</code> to
<code>ZZZ</code>, <code>...</code> and <code>row_number</code> is a number
starting at 1.</p>

<p>If the reference is to a slot in a different document from the one being
edited, <code>[filename]</code> is put before the slot reference where
<em>filename</em> is the name of the file containing the slot being referred
to.</p>

<p>Slot references are normally 'relative' which means that, if the reference
is replicated or copied from one slot to another, the difference in position
between the two slots will be added on to or subtracted from the reference.</p>

<p>Each half of the slot reference may be 'fixed' (made 'absolute') by
preceding the column letter or the row number by a dollar ($) sign, as in:</p>

<p style="margin-left:2em;"><code>$A$1</code></p>

<p style="margin-left:2em;"><code>AC$27</code></p>

<p>External references (ie references to slots in other documents) can be fixed
in the same way, as in:</p>

<p style="margin-left:2em;"><code>[fred]$A$1</code></p>

<p>The fixed part of a reference is not altered when copied with the <span
class="csguide-command">Copy Block</span>, <span
class="csguide-command">Replicate Down</span>, <span
class="csguide-command">Replicate Right</span> or <span
class="csguide-command">Replicate</span> commands.</p>

<p>When a slot to which a slot reference refers is deleted, the slot reference
is marked with a percent '%' sign to indicate that the reference is no longer
valid. Slots containing such formulae will display the <code>Bad slot</code>
error message.</p>

<h2>STRINGS</h2>

<p>Strings are entered between double quotes. Strings may contain spaces but
not control characters.</p>

<p>For example:</p>

<p style="margin-left:2em;"><code>"string with three spaces"</code></p>

<p>To include double quotes in a string use a pair of double quotes.</p>

<p>For example:</p>

<p style="margin-left:2em;"><code>"He said,""Hello!"""</code></p>

<p>Note that a slot reference to a text slot returns a string.</p>



<div class="navfooter">
<hr/>
<table width="100%" summary="Navigation footer">
<tr>
<td width="40%" align="left"><a accesskey="p" href="numberformats.html">Prev</a> </td>
<td width="20%" align="center"></td>
<td width="40%" align="right"> <a accesskey="n" href="options.html">Next</a></td>
</tr>
<tr>
<td width="40%" align="left" valign="top">Number Formats </td>
<td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td>
<td width="40%" align="right" valign="top"> Options</td>
</tr>
</table>
</div>
</body>
</html>
