<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="content-type" content="text/html; charset=iso-8859-1" />
  <title>Database functions</title>
  <meta name="generator" content="Amaya, see http://www.w3.org/Amaya/" />
  <link href="csguide.css" rel="stylesheet" type="text/css" />
</head>

<body>
<!-- This Source Code Form is subject to the terms of the Mozilla Public
   - License, v. 2.0. If a copy of the MPL was not distributed with this
   - file, You can obtain one at http://mozilla.org/MPL/2.0/. -->
<!-- Copyright (C) 1991-1998 Colton Software Limited
   - Copyright (C) 1998-2014 R W Colton -->
<div class="navheader">
<table width="100%" summary="Navigation header">
<tr>
<td width="20%" align="left"><a accesskey="p" href="customfns.html">Prev</a> </td>
<th width="60%" align="center">PipeDream 4 Reference Guide</th>
<td width="20%" align="right"> <a accesskey="n" href="databaseuse.html">Next</a></td>
</tr>
</table>
<hr/>
</div>

<h1>Database functions</h1>

<p>Database functions are variants of the functions AVG, COUNT, MAX, MIN, STD,
STDP, SUM, VAR and VARP.</p>

<p>They operate upon a range of slots (your database) subject to the condition
which forms their second parameter. Note that there is an example of each
database function in the PipeDream Examples archive.</p>

<p>Database functions all have the form:</p>

<p><code>D<em>function</em>(<span class="csguide-arg">range</span>,<span
class="csguide-arg">condition</span>)</code></p>

<p>For example, with:</p>

<div class="csguide-sample">

<table border="1">
  <col />
  <col />
  <col />
  <tbody>
    <tr class="csguide-border-colhead">
      <th></th>
      <th class="csguide-example-column">A</th>
      <th class="csguide-example-column">B</th>
    </tr>
    <tr>
      <th class="csguide-border-rowhead">2</th>
      <td>Jane</td>
      <td class="csguide-sample-number">1.00</td>
    </tr>
    <tr>
      <th class="csguide-border-rowhead">3</th>
      <td>Fred</td>
      <td class="csguide-sample-number">3.00</td>
    </tr>
    <tr>
      <th class="csguide-border-rowhead">4</th>
      <td>Alan</td>
      <td class="csguide-sample-number">10.00</td>
    </tr>
  </tbody>
</table>
</div>

<p style="margin-left:2em;"><code>DMAX(B2B4,B2B4&lt;10)</code></p>

<p>finds the maximum value in the range B2B4 which is less than 10, ie 3.00.</p>

<p>These functions can also be used to manipulate text strings. Use double
quotation marks to enclose text strings.</p>

<p>For example:</p>

<p style="margin-left:2em;"><code>DMAX(B1B3,A1A3&gt;="b")</code></p>

<p>finds the maximum value in the range B1B3 for which the corresponding value
in the range A1A3 starts with a letter greater than a. The answer here is 3.00
since this is the greatest value in column B whose corresponding value in
column A starts with a letter greater than a.</p>

<p>When scanning the range, PipeDream steps through each corresponding range in
the condition. In this example, A1 is the first slot examined when considering
B1, A2 for B2, etc. Any slot references in the condition are unaffected.</p>

<p>Text strings must be within double quotation marks.</p>

<p>You can use the wildcards <code>^?</code> (any single character) and
<code>^#</code> (any multiple character) in the second half of the
condition.</p>

<p>For example, with:</p>

<div class="csguide-sample">

<table border="1">
  <col />
  <col />
  <col />
  <col />
  <tbody>
    <tr class="csguide-border-colhead">
      <th></th>
      <th class="csguide-example-column">A</th>
      <th class="csguide-example-column">B</th>
      <th class="csguide-example-column">C</th>
    </tr>
    <tr>
      <th class="csguide-border-rowhead">1</th>
      <td>Jane</td>
      <td>Brighton</td>
      <td class="csguide-sample-number">1.00</td>
    </tr>
    <tr>
      <th class="csguide-border-rowhead">2</th>
      <td>Fred</td>
      <td>Blackpool</td>
      <td class="csguide-sample-number">3.00</td>
    </tr>
    <tr>
      <th class="csguide-border-rowhead">3</th>
      <td>Alan</td>
      <td>Coventry</td>
      <td class="csguide-sample-number">10.00</td>
    </tr>
    <tr>
      <th class="csguide-border-rowhead">4</th>
      <td>Mary</td>
      <td>Brighton</td>
      <td class="csguide-sample-number">4.00</td>
    </tr>
    <tr>
      <th class="csguide-border-rowhead">5</th>
      <td>Susan</td>
      <td>Coventry</td>
      <td class="csguide-sample-number">15.00</td>
    </tr>
  </tbody>
</table>
</div>

<p style="margin-left:2em;"><code>DCOUNTA(B1B5,B1B5="B^#")</code></p>

<p>returns 3 which is the number of items in the range B1B5 which begin with
'B'.</p>

<p>The database functions are as follows:</p>

<h2>DAVG</h2>

<p><code>DAVG(<span class="csguide-arg">range</span>,<span
class="csguide-arg">condition</span>)</code></p>

<p>Returns the average of values in the slots in the range for which the
condition is satisfied.</p>

<h2>DCOUNT</h2>

<p><code>DCOUNT(<span class="csguide-arg">range</span>,<span
class="csguide-arg">condition</span>)</code></p>

<p>Returns the number of number slots in the range for which the condition is
satisfied.</p>

<p>Note that this operates on number slots only.</p>

<h2>DCOUNTA</h2>

<p>As DCOUNT, but applies to all slots, not just number slots.</p>

<p>Usually DCOUNTA should be used in preference to DCOUNT.</p>

<h2>DMAX</h2>

<p><code>DMAX(<span class="csguide-arg">range</span>,<span
class="csguide-arg">condition</span>)</code></p>

<p>Returns the maximum value in the range for which the condition is
satisfied.</p>

<h2>DMIN</h2>

<p><code>DMIN(<span class="csguide-arg">range</span>,<span
class="csguide-arg">condition</span>)</code></p>

<p>Returns the minimum value in the range for which the condition is
satisfied.</p>

<h2>DSTD</h2>

<p><code>DSTD(<span class="csguide-arg">range</span>,<span
class="csguide-arg">condition</span>)</code></p>

<p>Returns the standard deviation in the range for which the condition is
satisfied.</p>

<p>This is the square root of the variance. See DVAR for the equation used.</p>

<h2>DSTDP</h2>

<p><code>DSTDP(<span class="csguide-arg">range</span>,<span
class="csguide-arg">condition</span>)</code></p>

<p>Returns the population standard deviation in the range for which the
condition is satisfied.</p>

<p>This is the square root of the population variance. See DVARP for the
equation used.</p>

<h2>DSUM</h2>

<p><code>DSUM(<span class="csguide-arg">range</span>,<span
class="csguide-arg">condition</span>)</code></p>

<p>Returns the sum of the values in the range for which the condition is
satisfied.</p>

<h2>DVAR</h2>

<p><code>DVAR(<span class="csguide-arg">range</span>,<span
class="csguide-arg">condition</span>)</code></p>

<p>Returns the variance of the values in the range for which the condition is
satisfied.</p>

<p>The equation used is:</p>

<p style="margin-left:2em;">(<span class="csguide-arg">n</span>&middot;(<span
style="font-size: 120%">&Sigma;</span>(<span
class="csguide-arg">x</span><sup>2</sup>)) - (<span
style="font-size: 120%">&Sigma;</span><span
class="csguide-arg">x</span>)<sup>2</sup>) &divide; <span
class="csguide-arg">n</span>&middot;(<span class="csguide-arg">n</span>-1)</p>

<p>where <span class="csguide-arg">x</span> is each value and <span
class="csguide-arg">n</span> is the number of values.</p>

<h2>DVARP</h2>

<p><code>DVARP(<span class="csguide-arg">range</span>,<span
class="csguide-arg">condition</span>)</code></p>

<p>Returns the population variance of the values in the range for which the
condition is satisfied.</p>

<p>The equation used is:</p>

<p style="margin-left:2em;">(<span class="csguide-arg">n</span>&middot;(<span
style="font-size: 120%">&Sigma;</span>(<span
class="csguide-arg">x</span><sup>2</sup>)) - (<span
style="font-size: 120%">&Sigma;</span><span
class="csguide-arg">x</span>)<sup>2</sup>) &divide; <span
class="csguide-arg">n</span><sup>2</sup></p>

<p>where <span class="csguide-arg">x</span> is each value and <span
class="csguide-arg">n</span> is the number of values.</p>



<table class="csguide-info-table">
  <col />
  <col />
  <tbody>
    <tr>
      <th>For information on</th>
      <th>See</th>
    </tr>
    <tr>
      <td>Other functions which operate upon a range of slots to produce
        statistics</td>
      <td><a href="statsfns.html">Statistical functions</a></td>
    </tr>
  </tbody>
</table>



<div class="navfooter">
<hr/>
<table width="100%" summary="Navigation footer">
<tr>
<td width="40%" align="left"><a accesskey="p" href="customfns.html">Prev</a> </td>
<td width="20%" align="center"></td>
<td width="40%" align="right"> <a accesskey="n" href="databaseuse.html">Next</a></td>
</tr>
<tr>
<td width="40%" align="left" valign="top">Custom Functions </td>
<td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td>
<td width="40%" align="right" valign="top"> Database Use</td>
</tr>
</table>
</div>
</body>
</html>
