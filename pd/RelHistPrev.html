<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>PipeDream - Ancient History</title>
</head>
<body>
<!-- This Source Code Form is subject to the terms of the Mozilla Public
   - License, v. 2.0. If a copy of the MPL was not distributed with this
   - file, You can obtain one at http://mozilla.org/MPL/2.0/. -->
<!-- Copyright (C) 1989-1998 Colton Software Limited,
   - Copyright (C) 1998-2015 R W Colton -->

<h1>PipeDream Ancient History - pre-4.57</h1>
<!-- Obtained by View Source on Drupal page -->

<p><strong>4.56.02 (19 Mar 2019)</strong></p>
<p>Fix CHOOSE() when used with range or array parameters. This had been broken since 4.52/04.</p>
<p>ROOL DDE 28 build environment used.</p>
<p><strong>4.56.01 (21 Dec 2018)</strong></p>
<p>Define Function Key compatibility issue with old files fixed.</p>
<p><strong>4.56 (17 Dec 2018)</strong></p>
<p>PipeDream menus and keyboard shortcuts are now a little more Style Guide compliant. Existing users may wish to head to the iconbar menu and turn on 'Classic menus' and 'Save Choices'.</p>
<p>Fixed chart text object editing bug.</p>
<p>Fixed chart loading bug introduced in 4.50/45.</p>
<p>Fixed spreadsheet range recognition code so that the end cell reference of a range of cells is correctly updated when it is used to define a name. This had been broken since 4.55.00.</p>
<p>Updated spreadsheet cell reference recognition code to accept a leading percent to indicate 'Bad reference'. This is needed as saved documents with such bad references (e.g. when the referenced cell has been deleted) would otherwise fail to load correctly.</p>
<p>Fixed subtraction code: subtracting extremely large numbers of individually small integers could have eventually given an undetected integer overflow.</p>
<p>Fixed execution of command files from the Do command file dialogue box.</p>
<p>Speed-up for M_DETERM() and M_INVERSE() for large sparse matrices.</p>
<p>DDB() spreadsheet function accepts an extra parameter, factor (optional). The default is 2.0.</p>
<p>INDEX() spreadsheet function will now accept zero for the column and/or row number.<br />
If the column number is zero, the whole of the specified row(s) is returned.<br />
If the row number is zero, the whole of the specified column(s) is returned.</p>
<p>INDEX() spreadsheet function will now accept zero for the optional column and/or row size.<br />
If the column size is zero, the rest of the specified row(s) beginning at the given column number is returned.<br />
If the row size is zero, the whole of the specified column(s) beginning at the given row number is returned.</p>
<p>SERIESSUM() spreadsheet function has been backported from Fireworkz. An example of its use is given in the PipeDream Examples package.</p>
<p>Text @-field handling enhanced to allow colour and font change information contained in refrerenced cells to be inserted into the referencing cell's output when @<em>cell_reference</em>@ is used and a global font is in use.</p>
<p>Text @-field handling enhanced to allow use of HTML format colour strings: @C:#<em>rrggbb</em>@, @C:rgb(<em>r,g,b</em>)@, @C:<em>html_colour_name</em>@.</p>
<p>Text @-field handling enhanced to allow use of format strings with date, time and page number fields: @D:<em>date_format</em>@, @N:<em>time_format</em>@ and @P:<em>number_format</em>@. @D@, @N@ and @P@ without format strings give the same results as before. The format strings are those used by the TEXT() spreadsheet function.</p>
<p>Examples:<br />
@D:yyyy-mm-dd@ displays the current date in ISO 8601 format,<br />
@T:hh:mm@ displays the current time without seconds,<br />
@P:r#@ displays page numbers as lower-case Roman numerals.</p>
<p>Note that both current date and time components are passed to @D@ and @N@ to enable a composite date with time string to be displayed.<br />
Example:<br />
@D:yyyy-mm-dd\Thh:mm:ss@ displays an ISO 8601 date/time.</p>
<p>Typing a text-@ character or clicking on a highlight Toolbar button (e.g. Bold) enters the data as text when the caret is in an empty cell regardless of the New cell format option.</p>
<p>Insert colour command (\EITC) added to the Edit menu. This command allows the user to choose a colour using the ColourPicker module and inserts the corresponding @C:<em>r,g,b</em>@ sequence.</p>
<p>Insert date (\EITD), time (\EITN) and page number (\EITP) commands added to the Edit menu. These commands allow the user to choose an appropriate format string and insert the corresponding text-@ sequence with the chosen format string.</p>
<p>Chart Fill Style dialogue box now works in &gt;16 colour modes and centres Markers / Pictures in the icon.</p>
<p>Insert option on Choices menu replaced by Overtype option for clarity.</p>
<p>Replicate command restored to short menus.</p>
<p>Replicate Left (\BRL) and Replicate Up (\BRU) commands implemented and added to long menus. These may also be accessed by clicking Adjust on the Replicate Right and Replicate Down buttons respectively.</p>
<p>Fixed running a PipeDream command file when PipeDream is not running. This had been broken since 4.52.00.</p>
<p>When running on a version of RISC OS where clicking in the Filer causes the Filer to acquire the input focus, double-clicking a PipeDream Command file in the Filer will execute that command file in the context of the document that had the input focus before it was acquired by the Filer.</p>
<p>Record command file will once again create command files in the same directory as the current document. If the current document has not been saved, it will create the command file in &lt;Choices$Write&gt;.PipeDream.CmdFiles.</p>
<p>Do command file will now list any command files found in the same directory as the current document (and in any subdirectory CmdFiles thereof) in addition to those found on the path.</p>
<p>Dump dictionary and Merge dictionary processing enormously speeded up on newer systems.</p>
<p>Colour handling has been improved to allow selection of arbitrary colours for each PipeDream display element using the ColourPicker module. Previously such selection was restricted to the Window Manager 16-colour palette. Where a newly selected colour exactly matches that in the Window Manager 16-colour palette, its palette index is displayed, otherwise the corresponding HTML colour code #RRGGBB is displayed.</p>
<p>The PipeDream colour constructs have been extended to store new colours and now take the extended form: %OP%C&lt;c&gt;,&lt;index&gt;{,0xBBGGRR00} (the hexadecimal colour parameter is omitted for exactly matching colours).</p>
<p>English date format relabelled as D.M.Y in the Options dialogue box and referred to as British-style in documentation. American date format similarly relabelled as M.D.Y</p>
<p>The Load file dialogue box is now only created as a RISC OS submenu if it is invoked by traversing the RISC OS menu structure using the arrow at the right of the Load menu option. If the Load file dialogue box is invoked by clicking on the Load menu option, from a command sequence (^FL) or a user-defined mapped keystroke, it is opened as a standalone dialogue box. This allows the user to then find a directory viewer containing files to be loaded without the dialogue box collapsing. A file may then be dragged into the Load file dialogue box, filling the file name field, and options relevant to loading that file selected. To cancel the dialogue box, press ESCAPE or click the Cancel button. Note that no other PipeDream dialogue boxes can be invoked whilst the Load dialogue box is being shown as a standalone dialogue box.</p>
<p>Save/Discard/Cancel and Yes/No dialogue boxes have been cosmetically improved by splitting the message that was output into a (possibly quite long) statement followed by a shorter discrete question.</p>
<p>A Web button (and a PipeDream logo) has been added to the About this program dialogue box. This uses the PipeDream$Web variable set by !Run.</p>
<p>Window Manager flags bit is set to save and restore FP state over SWI Wimp_Poll and Wimp_PollIdle calls rather than doing it manually.</p>
<p>The PipeDream application and file icons have been smartened up to better match the actual PipeDream 4 logo artwork.</p>
<p>180 DPI application and file icons supplied in RISC OS 5 style.</p>
<p>Toolbar icons appearance improved and 180 DPI toolbar icons supplied; some toolbar icons are now derived from the public domain Tango Icon Library.</p>
<p>Toolbar is slightly less tall, leaving some more room for data.</p>
<p>Mark document/Clear selection Toolbar button added, replacing the box to the left of the column headings.</p>
<p>Using one of the highlight Toolbar buttons with a marked block now redraws correctly. Additionally, the corresponding option is set in the Remove highlights dialogue box in case you wish to remove the highlights thus set.</p>
<p>Clicking Adjust on the Left justify Toolbar button will restore the default justification on the marked block (or current cell).</p>
<p>Clicking Adjust on the Decimal places Toolbar button will restore the default format on the marked block (or current cell).</p>
<p>Clicking Adjust on Toolbar buttons with no alternate function defined will no longer execute the standard function used when Select is clicked.</p>
<p>Formula Editing Window buttons more consistent with Toolbar buttons.</p>
<p>Copy/Cut/Paste buttons added to Formula Editing Window.</p>
<p>Clicking Adjust on the Tick button transfers the formula line contents to the Formula Editing Window.</p>
<p>Multi-line formula editing (and chart text) window only uses fonts if a Desktop font is in use.</p>
<p>Unintentional zero page access when loading blank file name fixed.</p>
<p>Top level Help menu entry added.</p>
<p>Interactive Help messages are now given for the Formula Editing Window buttons.</p>
<p>Interactive Help messages are now more consistent with the RISC OS Style Guide recommendations and use Help tokens where possible.</p>
<p>Writeable icons in Spell Create/Open/Pack user dictionary dialogue boxes use RISC OS Style Guide compliant appearance and size.</p>
<p>Menus are no longer padded to a fixed field width with spaces.</p>
<p>    Application resources moved from !PipeDream.Resource. to !PipeDream.AppData.<br />
    Language-specific resources (Dictionaries, Dictionary Definition Files, Document Templates, PipeDream Printer Drivers) are located in a sub-directory of AppData.<br />
    The only one currently provided fully populated is UK.<br />
    The Deutsch DictDefn file is provided in the Germany directory.<br />
    Language-neutral resources (Markers, Pictures) may be found in the Neutral sub-directory of AppData.<br />
    PipeDream$Path is set by !Boot and !Run and is used to locate these resources.</p>
<p>    RISC OS-type resources are now located in !PipeDream.Resources.<br />
    (They had previously been separated out of the Resource directory into a RISC_OS sub-directory).<br />
    Language-specific RISC OS-type resources (Help, Messages, Sprites, Window Templates) are located in a sub-directory of Resources.<br />
    The only one currently provided is UK.<br />
    Language-neutral RISC OS-type resources (Loader, ImageSlot) may be found in the Neutral sub-directory of AppData.<br />
    A new variable, PipeDreamRes$Path, is set by !Run and is used to locate these resources.<br />
    Verified that themed variants of these resources, e.g. iMX6, can be loaded on RISC OS 5 if provided by the user.</p>
<p>    Resources.UK.Help.HTML is a directory containing helpful info and supersedes the old HTMLHelp file.<br />
    It now contains Command Reference, Spreadsheet Functions and Toolbar information.</p>
<p>Internal error handler improved to show Continue and Quit button pair with more logical outcomes.</p>
<p>Stack overflow handler fixed - no longer gives 'Uncaught trap'.</p>
<p>Release notes are now located at top level in !PipeDream.</p>
<p>ROOL DDE 27 build environment used.</p>
<p><strong>4.55.04 (01 Aug 2016)</strong></p>
<p>CODE() spreadsheet function extended to accept empty string as input (in which case it returns zero).</p>
<p>Custom function debugging assisted by outputting errors encountered as<br />
<code>ERROR_CUSTOM: [<em>cf_doc_name</em>] Row <em>N</em> Error <em>String</em></code><br />
to Reporter module if it is loaded and enabled.</p>
<p><strong>4.55.03 (27 Jul 2016)</strong></p>
<p>Choosing a spreadsheet function from the function selector enters the formula editing line when clicked on an empty cell regardless of the New cell format option.</p>
<p>The Copyright file in the PipeDream package explicitly includes a copy of the Mozilla Public License, v. 2.0.</p>
<p><strong>4.55.02 (12 Jul 2016)</strong></p>
<p>Formula editing window (obtained by pressing Ctrl-Return in the formula line) uses DejaVuSans.Mono if it is available AND a Unicode Font Manager is in use.</p>
<p>Showing cell / range / name values from function menu puts a colon suffix after the cell reference / range / name.</p>
<p>Function menu now allows cell / range values to be evaluated in custom function sheets again. This had been deliberately disabled in 4.52/06 but there can be a real use for this when debugging custom function sheets!</p>
<p>Correctly accumulates spaces between symbols when compiling formula for number cell. This had been broken since 4.52/08 when leading equals sign was first allowed. Trailing spaces before an internal newline are omitted.</p>
<p><strong>4.55.01 (03 Jul 2016)</strong></p>
<p>'Check overwrite file' dialogue box will take priority over any possibly persisting Save dialogue box</p>
<p><strong>4.55 (21 May 2016)</strong></p>
<p>PipeDream chart files are now PRM-conformant Draw files and can be loaded by Draw, Vector and Fireworkz when the file type is set to Draw. They can still be loaded by previous versions of PipeDream.</p>
<p>Image file loader updated to handle Vector files.</p>
<p>Image file loader updated to handle sprites with mode selectors.</p>
<p>Image file loader updated to better handle JPEGs.</p>
<p>Uses ChangeFSI, if available, to convert a much wider range of image file formats.</p>
<p>On machines where the OS is not shadowed in RAM, you can improve ChangeFSI's performance by first typing '*RMFaster BASIC'.</p>
<p>Scrap files for image conversion are created in the &lt;Wimp$ScrapDir&gt;.PipeDream directory.</p>
<p>Fixed potential error leak in LINEST().</p>
<p>Fixed URLs in notes for new CMS.</p>
<p>Coloured tick and cross for accept / cancel buttons of formula line.</p>
<p>Document file sprites have turned-up bottom right corner.</p>
<p>Fixed long-standing spell check dictionary creation / packing exception.</p>
<p>Dropped support for ancient 'Integrale' format spell check dictionaries which required ODctDefn.</p>
<p>Updated Master dictionary with many new words (from SCOWL). The Master dictionary that now ships with PipeDream contains words with -ise style endings which are common in written British English. A Master dictionary containing words with -ize style endings (<a href="https://en.wikipedia.org/wiki/Oxford_spelling">Oxford English Dictionary spelling</a>) may be obtained from the web site and substituted for that shipped with PipeDream. The old PipeDream dictionary containing both -ise and -ize style endings may also be obtained from the web site. (See PipeDream Dictionaries Archive)</p>
<p><strong>4.54 (22 Nov 2015)</strong></p>
<p>Dialogue box fields and buttons in Templates updated to conform to Style Guide Issue 3. These still work OK with RISC OS 4.39 styled icons and if a slightly larger Desktop font for is selected for readability (tested with 14pt Homerton.Medium set by Paul Vigay's !MiscSetup).</p>
<p><strong>IMPORTANT</strong>: Quit query dialogue box buttons have been reordered to be Style Guide Issue 3 compliant (Discard / Cancel / Save). Take care to click in the right place! The Save-on-close dialogue box now uses the same button set as the Quit query dialogue box.</p>
<p>References to 'Slot' replaced by 'Cell' to better relate to other spreadsheet terminology.</p>
<p>Fix for lines longer than the maximum window width causing unrelated nearby memory to be accessed.</p>
<p>If a PipeDream macro file is open for editing in PipeDream, double-clicking on it or dragging it to the PipeDream icon will bring the corresponding document window to the front, as happens with other documents, rather than executing it.</p>
<p>'Can't load this type of file' error will be given when DataPower, Lotus .WK1/.WK3 or Microsoft Excel files are dragged to PipeDream.</p>
<p>COUNTA() spreadsheet function has been backported from Fireworkz.</p>
<p>SORT() spreadsheet function uses zero-based column index as per documentation (and Fireworkz).</p>
<p>AVG() / MAX() / MIN() / SUM() functions now actually use the optimised for integer arguments code that has been in there and laying dormant for twenty-odd years!</p>
<p>Formula editing window (obtained by pressing Ctrl-Return in the formula line) uses DejaVuSans.Mono if it is available.</p>
<p>Fix for loading chart file before the document on which it is dependent.</p>
<p>The 3-D chart terms roll and pitch have been replaced by the terms turn and droop that better describe their actions (chart turns about y-axis, floor of chart droops forwards from the x-axis).</p>
<p>Selected objects in chart editing window are indicated using improved exclusive OR colour selection code.</p>
<p>Chart legend object may be resized in chart editing window by dragging on its top left corner (or bottom right corner as before).</p>
<p>Cancel buttons in chart style dialogue boxes.</p>
<p>Chart dialogue boxes no longer have a close icon (and thereby possibly unwanted iconise icon) on the title bar.</p>
<p>Dashed lines in charts work correctly.</p>
<p>Polygonal Draw objects in charts now closed correctly.</p>
<p>Non-rectangular quadrilateral Draw paths in charts use rounded joints. This avoids mitred joints of non-Thin lines poking well beyond 3-D bars.</p>
<p>Greatly improved click selection of objects in charts; more refined tests are applied if the simple object bounding box is hit.</p>
<p>Acorn SID format files will be detected and loaded as CSV.</p>
<p>Some JPEG/JFIF files (e.g. with thumbnail pictures) were not being automatically detected as such.</p>
<p>ROOL DDE 26 build environment used.</p>
<H4>4.53/06 (21 Sep 2015)</H4>
<p>Choices:PipeDream. replaced by &lt;Choices$Write&gt;.PipeDream. in the PipeDream$Path variable. This should allow better resolution of custom function files when they have been opened by Shift-click on the PipeDream icon.</p>
<p>ROOL DDE 25 build environment used (used ROOL DDE 20 for 32-bit builds prior to this release).</p>
<p>Lotus 1-2-3 file converters moved out to separate packaged utilities.</p>
<H4>4.53/05 (14 Sep 2015)</H4>
<P>IconSprites !SpritesR5 on RISC OS 5.</P>
<P>Modernised pinboard icon in !SpritesR5 to RISC OS 5 style.</P>
<H4>4.53/04 (04 Sep 2015)</H4>
<P>Fixed cell reference detection to no longer allow row zero.</P>
<P>Pressing a key will terminate the splash screen early, as does clicking the window.</P>
<P>Modernised pinboard icon in !Sprites22 to RISC OS 4 style.</P>
<H4>4.53/03 (06 Aug 2015)</H4>
<P>Converting a number cell containing an undefined custom function reference to text fixed.</P>
<P>Date format extended to accept five 'm' or 'M' characters to yield first character of month name.</P>
<H4>4.53/02 (09 Jul 2015)</H4>
<P>Timing-dependent zero-page access during chart loading fixed.</P>
<H4>4.53/01 (07 Jul 2015)</H4>
<P>REPT() spreadsheet function now handles repeat count of zero correctly. Since 4.50/40, this gave an error; prior to that it produced one copy of the string.</P>
<H4>4.53 (10 Jun 2015)</H4>
<P>CEILING() and FLOOR() spreadsheet functions have been backported from Fireworkz
(see Addenda and errata).</P>
<P>INT() spreadsheet function now rounds better for non-power-of-two target integer values.</P>
<P>IRR() spreadsheet function now converges faster (poor initial conditioning).</P>
<P>LOG() spreadsheet function now accepts an optional base parameter.</P>
<P>Number formatter used by TEXT() spreadsheet function handles blank cells and PipeDream error numbers.</P>
<P>Reinstated Colton Software copyright in splash screen and made dates consistent with LICENCE files.</P>
<P>When inserting text files (as TAB or Paragraph) cell references in text @-fields are not updated.
This allows copying common text fragments directly from an editor or template files without unwanted modification.</P>
<h4>4.52/08 (18 Dec 2014)</h4>
<p>Templates adjusted to cater for use of a larger Desktop font for readability (used 14pt Homerton.Medium set by Paul Vigay&#8217;s !MiscSetup).</p>
<p>Replaced PipeDream&#8217;s flawed date handling code with code backported from Fireworkz.</p>
<p>Formulae may be entered with an optional leading equals sign.</p>
<p>Category names and function categorisation in spreadsheet function menu are more consistent with (updated) documentation.</p>
<p>BIN() spreadsheet function has always taken an arbitrary shaped array or range of data as its first parameter. Previously only the first column of this data would have been binned; now all the supplied data is binned.</p>
<p>BINOM() spreadsheet function removed &#8211; this was just a synonym for COMBIN().</p>
<p>BETA(), FACT(), GAMMALN() spreadsheet functions now use the lgamma() function provided by the SharedCLibrary (used to be FreeBSD implementation). Results may differ around the 15th digit.</p>
<h4>4.52/07 (05 Nov 2014)</h4>
<p>!Run ensures ColourPicker module is available on startup &#8211; this module is used in colour selection in charts, and PipeDream would otherwise fail on systems where this was not already loaded, e.g. RISC OS 3.1.</p>
<h4>4.52/06 (01 Nov 2014)</h4>
<p>Splash screen now creates a window in which to render objects.</p>
<p>Improve appearance of toolbar on RISC OS 4.39 when &#8216;Apply to sprite icons&#8217; effect is selected.</p>
<p>Use newer error reporting mechanism on RISC OS 3.5 and later.</p>
<p>Yes / No query dialogue boxes, anagram and browsing, alert and input dialogue boxes and the formula editing window no longer have a close icon (and thereby possibly unwanted iconise icon) on the title bar.</p>
<p>Multi-line formula editing (and chart text) window now uses Corpus.Medium rather than VDU 5 font if possible.</p>
<p>Function menu substitutes non-break space for space when displaying slot / range content to get around Window Manager attempts to right-justify certain keywords.</p>
<p>Function menu extended to show dependent slots / ranges / names for text and empty slots as well as number slots.</p>
<p>Function menu no longer attempts to show dependent slots / ranges / names for slots in custom function sheets as this is meaningless.</p>
<p>Font Selector dialogue box is now closed when another dialogue box is opened.</p>
<p>Font Selector dialogue box now acts as a persistent &#8216;standalone&#8217; dialogue box (like Save) with respect to window / application closing.</p>
<p>Font Selector dialogue box no longer opens when another persistent &#8216;standalone&#8217; dialogue box such as Save is already open.</p>
<p>Automatically generated temporary arrays of strings (e.g. REPT(text_cell_reference, {1,2,3})) no longer cause heap corruption (problem exposed by changes in 4.50/39).</p>
<p>LISTCOUNT() spreadsheet function backported from Fireworkz.</p>
<p>SORT() spreadsheet function no longer masks potential memory full errors during creation of temporary data array prior to the sort.</p>
<p>Problem with Ctrl-CGS (Goto Slot) and long document names fixed.</p>
<h4>4.52/05 (16 Jul 2014)</h4>
<p>Problem with ROUND() spreadsheet function fixed.</p>
<p>Improved text and layout of Save/Discard/Cancel dialogue box on exit with modified document(s).</p>
<h4>4.52/04 (04 Jul 2014)</h4>
<p>Issue with PipeDream&#8217;s font cache mechanism could sometimes lead to highlighted text not being rendered in the correct font variant.</p>
<p>Text @-fields containing cell references to other cells containing text @-fields containing cell references now render sensibly, allowing text to be concatenated. There is a fixed depth limit of nine (rather than the old effective limit of one).</p>
<p>Text @-fields containing cell references to other cells containing text @-fields containing cell references (and these didn&#8217;t get expanded, by the way: see above) could yield incorrect cell references when the target cell was deleted. This has been there since the very early days of PipeDream as far as I can see! Any text @-field containing a bad cell is displayed with a leading percent character, as it would be shown for bad cell references in formulae.</p>
<p>Text @-fields containing cell references could yield incorrect cell references when updated (broken in 4.50/43). Several slightly inconsistent instances of cell reference reading/writing code replaced with fast consistent routines.</p>
<p>Propagated errors now contain a reference to the cell that generated the initial error to help fault-finding.</p>
<p>Unary plus and minus operators and ABS() spreadsheet function no longer unnecessarily convert integer arguments to floating point.</p>
<p>If the <i>length</i> parameter is omitted for LEFT() and RIGHT() spreadsheet functions, <i>length</i> of 1 is assumed. A <i>length</i> of 0 is now allowed (consistency with MID()).</p>
<p>AVG() and SUM() spreadsheet functions fixed: operating on extremely large ranges of individually small integers could eventually give an undetected integer overflow.</p>
<p>LOGEST() spreadsheet function fixed: could have crashed PipeDream when given fewer than three parameters.</p>
<p>M_INVERSE() spreadsheet function now yields correct error for non-square input matrix.</p>
<p>Calculation of determinants of large matrices would have caused heap corruption.</p>
<p>Very large numbers formatted as X# (column name) could have crashed PipeDream.</p>
<p>Group box captions use better icon style for patterned background.</p>
<p>Changed writeable field height to 60 OS units &#8211; the RISC OS Style Guide&#8217;s suggested 68 OS units is way too tall.</p>
<h4>4.52/03 (18 Feb 2014)</h4>
<p>tboxlibs&#8217; flex module compiled into PipeDream (with patches). Added shrink_forbid option (needed for running out of memory when printing problem as for 4.50/09). Added flex allocation granularity mechanism to tboxlibs&#8217; flex module to avoid unnecessary overheads and slot/area thrashing.</p>
<p>Spurious carriage return characters removed from Messages file.</p>
<p>No longer supports squashed Messages file (for source clarity).</p>
<h4>4.52/02 (12 Feb 2014)</h4>
<p>PipeDream released under the Mozilla Public License 2.0 (MPL).</p>
<p>The installed Event and Escape handlers are now truly 26/32-bit agnostic: they do not modify flags, so do not attempt to restore them.</p>
<h4>4.52/01 (09 Feb 2014)</h4>
<p>Initialisation order with flex and dynamic areas fixed. Caused exception on shutdown if fonts had been used in any documents when a dynamic area had been created (bug was introduced in 4.51).</p>
<h4>4.52 (06 Feb 2014)</h4>
<p>PipeDream package created for use with !PackMan or RiscPkg. If you do not wish to use a package manager, you may extract !PipeDream as before from the ZIP archive &#8211; it is in Apps.Document.</p>
<p>Choices directory moved back from top level into !PipeDream as uChoices to assist packaging. PipeDream will now test for the existence of choices in &lt;Choices$Write&gt;.PipeDream on startup and, if needed, copy the default choices directories and files from uChoices over to Choices:PipeDream.</p>
<p>As before, please note that if you already have modified user dictionaries etc. in a previous non-choices installation of PipeDream (i.e. one prior to 4.50/37), you may wish to copy the contents of your existing &lt;PipeDream$Dir&gt;.User tree into the new location &lt;Choices$Write&gt;.PipeDream.</p>
<p>If so, run your old !PipeDream (to set the correct &lt;PipeDream$Dir&gt;) and type the following in a (Ctrl-F12) Task window:</p>
<pre>CDir &lt;Choices$Write&gt;.PipeDream
Copy &lt;PipeDream$Dir&gt;.User.* &lt;Choices$Write&gt;.PipeDream.* ~CF~NRV
</pre>
<p>Release notes are now in HTML format and linked into !Help.</p>
<p>Changed release notes to include PipeDream Google Group info (was Fireworkz).</p>
<p>Changed Loader to display PipeDream Google Group info (was Fireworkz).</p>
<h4>4.51 (06 Jan 2014)</h4>
<p>Fonts used in Draw files that are used as pictures / markers in charts now match up with existing fonts in the charts much better. It is now also possible to include Draw files that use text in a font that is otherwise unused in the chart: since 4.50/41 (when an optimised font table was added) this would have mapped text in the included font to display using System font.</p>
<p>PipeDream now works out when null events are required and also registers the list of messages in which it is interested with the Window Manager (helps overall RISC OS Desktop efficiency).</p>
<p>Use tboxlibs&#8217; flex module for deferred compaction.</p>
<p>Fixed SIGOSERROR handling and reporting of other exceptions.</p>
<p>Patched out more unused bits of RISC_OSLib.</p>
<p>Replaced multiple calls to OS_WriteC with OS_WriteN to speed graphics past the VDU funnel and multiple SWI overheads.</p>
<p>Calls to OS_Plot via SWI CallASWI replaced with direct SWI OS_Plot.</p>
<p>Many more return paths from Window Manager (and other) SWIs now check for unlikely, but still possible, errors which could otherwise have been hidden and not reported. Use of inline function wrapper means this is just a CMP #0; BLNE report per call.</p>
<p>PipeDream can now be built on 32-bit systems, including RPCEmu (RO 5.20).</p>
<p>PipeDream repository converted to Subversion (from CVS).</p>
<p>Fixed !Help for Save dialogue box.</p>
<p>Messages file now supplied uncompressed and unpreprocessed.</p>
<p>No longer supports squashed Sprites or Sprites22.</p>
<p>Reporter output is now disabled by default. It may be enabled by *Set PipeDream$ReportEnable 1 before running PipeDream.</p>
<h4>4.50/50 (08 Aug 2013)</h4>
<p>Adjust-clicking the Yes (or No) button in Yes/No choice dialogue boxes acts as if the No (or Yes) button had been clicked. This restores the sense prior to the 4.50/49 fix. This also applies to the Save/Discard choice box.</p>
<p>Sequences of consequent dialogue boxes (when closing PipeDream with a number of modified documents) now remember the Yes/No dialogue box position for the subsequent Yes/No dialogue box to be opened at, preventing the progressive crawl of dialogue boxes towards the bottom right of the screen if any modified document was saved.</p>
<h4>4.50/49 (02 Aug 2013)</h4>
<p>Fixed page numbering on printing. This had broken in 4.50/37 when code to handle printing multi-file documents was removed (support for multi-file documents themselves having been dropped many many moons ago).</p>
<p>Fixed RISC OS printing with line spacing &gt; 1 and grid turned on.</p>
<p>Quit messsage with edited documents made more helpful.</p>
<p>Removed spurious &#8216;&gt;&#8217; from Edit Name menu entries.</p>
<p>Text @-field sequences are all now fully expanded when displaying the contents of a string cell in the same way as a text cell would be. Prior to this version, the display of string cells containing text @-field sequences was inconsistent (PipeDream did try to use font and colour changes, but not date, title etc. expansion) and was in fact broken.</p>
<p>Adjust-clicking the OK button in dialogue boxes to allow sub-menu persistence works again (it was broken for most dialogue boxes in 4.50/36 where Cancel buttons were added but there were already a couple where it would have gone wrong anyway; all due to non-zero ESG usage on action buttons being a hangover from RISC OS 2 menu-style buttons).</p>
<p>More robust error handling of malformed command args from command files or key expansion: in some cases it could have tried to pop up a dialogue box.</p>
<h4>4.50/48 (28 Jun 2013)</h4>
<p>Numbers template now uses Homerton.Medium font. There is also a copy of the previous Numbers template, shipped as Numb_Plain, that still uses the system font.</p>
<p>Save Choices command moved into the PipeDream icon bar Choices sub-menu.</p>
<p>The user name &amp; organisation name are no longer displayed in the &#8216;About this program&#8217; dialogue box as PipeDream is now free-to-use and no longer has a registration process. If you have upgraded PipeDream from a paid version and have valid registration information in &lt;PipeDream$Dir&gt;.Info, it will still be displayed on the splash screen and stored in your saved files.</p>
<p>Help command added to the PipeDream icon bar menu for ease of access.</p>
<p>PipeDream Help now also mentions the on-line Tutorial.</p>
<p>Certain commands are no longer greyed out on menus when in expression editing as they do specifically cater for this case:</p>
<ul>
<li>Next Match,</li>
<li>Previous Match,</li>
<li>Replace *,</li>
<li>Search.</li>
</ul>
<p>* Command does not appear on visible menus.</p>
<p>Superfluous (since 1989!) field removed from menu structures.</p>
<p>The field in the Print dialogue box that contains the Printer name now has a transparent background so as to conform with textured window backgrounds.</p>
<p>Background colour of the text section in the splash screen adjusted to be closer to that of the image background on high-colour displays.</p>
<p>PD3Keys command file is no longer shipped &#8211; you&#8217;ve all had plenty of time to adapt!</p>
<h4>4.50/47 (24 Jun 2013)</h4>
<p>Save processing now always ignores RISC_OSLib&#8217;s initially poorly defined xfersend_file_is_safe() state unless the save has been performed using xfersend() &#8211; i.e. by dragging the file icon or clicking OK in the Save dialogue box. This fixes the long-standing \Fgs failure to reset the file modified flag problem.</p>
<p>Standalone Save dialogue box re-enabled now \Fgs problem fixed.</p>
<p>Pressing ESCAPE during a non-PipeDream file save could possibly not abort the save process if recalculation was not complete.</p>
<p>File-&gt;About now shows correct file modification date again.</p>
<h4>4.50/46 (20 Jun 2013)</h4>
<p>Standalone Save dialogue box temporarily disabled while we try to get to the bottom of a particularly opaque \Fgs problem.</p>
<p>Pop-up version (one that does not read its arguments from a command file or function key) of the Save dialogue box created for use when \Fgs|M is issued in a command file or function key expansion and the current document does not yet have a full pathname.</p>
<p>Macro recording could sometimes fail when writing out a post-command newline.</p>
<p>Full pathname of macro file given when write fails.</p>
<p>More commands greyed out on menus when in expression editing.</p>
<p>No longer explicitly set Spell Dump Dictionary output buffer size (it was smaller than the current default).</p>
<p>Dump Dictionary is now much faster with empty template for quicker dictionary maintenance (it updates the on-screen dialogue box less often and processes more words per null event).</p>
<h4>4.50/45 (05 Jun 2013)</h4>
<p>HTML Help now refers to the online PipeDream Reference Guide.</p>
<p>When dragging, e.g. column width adjusting, inappropriate BubbleHelp for PipeDream document windows is suppressed.</p>
<p>Files loaded from sources that are not deemed as &#8216;safe&#8217;, e.g. as a selection dragged to the PipeDream icon from another editor, are once again marked as modified and untitled, rather than as unmodified and with the name of the Scrap file used for the transfer (was broken in 4.50/41).</p>
<p>Inserting a file which contains external references now causes the document into which it is inserted to attempt to load any newly supporting documents.</p>
<p>Inserting files, either by dragging or Ctrl-FL, no longer cause the document window to be re-opened at a &#8216;new document&#8217; position.</p>
<p>PipeDream&#8217;s dialogue box processing no longer greedily steals the caret back to the current field in open dialogue boxes, so allowing the user to perform other useful tasks (e.g. file rename, directory creation) whilst in a standalone dialogue box such as Save file.</p>
<p>The Save file dialogue box now attempts to restore the caret on closing when it is opened as a standalone dialogue box.</p>
<p>Several potential buffer overflow bugs (esp. with long filenames) fixed.</p>
<p>32-bit Lotus 1-2-3 converter utilities u_ltp (Lotus to PipeDream) and u_ptl (PipeDream to Lotus) are now supplied in PipeDream&#8217;s Resource.RISC_OS directory (this being a bit more out of the way of other files loaded on the PipeDream path). Please note that there is no cute front end tool &#8211; you will need to invoke them in a (Ctrl-F12) Task window:</p>
<pre>PipeDream:RISC_OS.u_ltp &lt;infile-lotus&gt; &lt;outfile-pipedream&gt;
PipeDream:RISC_OS.u_ptl &lt;infile-pipedream&gt; &lt;outfile-lotus&gt;
</pre>
<h4>4.50/44 (13 May 2013)</h4>
<p>Failed supporting document load reporting in 4.50/43 had the unwanted side-effects of (a) stopping any subsequent supporting document loading for that stack of dependent and supporting documents and (b) possibly aborting any command file execution.</p>
<p>Some useful error messages were being suppressed.</p>
<p>All error messages displayed in Window Manager Message Box are now additionaly logged to Reporter.</p>
<p>Supply the user Choices directory in the top-level alongside !PipeDream. Please refer to the ReadMe in the Choices directory for further details.</p>
<h4>4.50/43 (09 May 2013)</h4>
<p>The spreadsheet evaluator and general document internal identifiers have been unified (like in Fireworkz) to rid PipeDream of this artificial and unnecessary distinction. This had hampered getting to the bottom of many external reference and supporting document loading problems through the years. It also simplifies the document handling to spreadsheet module interface code somewhat (with incidental speed up).</p>
<p>Loading supporting documents and external references code rationalised. Where some of the supporting documents were being loaded along PipeDream$UserPath, a redundant and sometimes conflicting copy of a file name variable was present before, also the &#8216;looser match&#8217; flags was not being set correctly in all cases.</p>
<p>These two modifications above also permit supporting documents with the same leafname but in different directories to be loaded at the same time, e.g. ADFS:&#8230;Tax.2012.Summary would load supporting files Rental and Bank from &#8230;2012 but loading ADFS:&#8230;Tax.2013.Summary at the same time would load the supporting files with the same names from &#8230;2013 as you would want rather than refusing.</p>
<p>Failed supporting document load is now reported (to screen and log) again.</p>
<p>When a document window that contains the input focus in a cell is reduced in extent, the caret is correctly repositioned within the adjusted current cell position.</p>
<p>Double-clicking on a document icon in a directory viewer that is already loaded in PipeDream (whether modified or not) will simply bring that document to the front, acquiring the input focus. This also applies to a document icon being dragged to the PipeDream icon on the icon bar.</p>
<p>Double-clicking on a chart file icon that is used in a PipeDream document simply shows it in a chart editing window without giving an &#8216;already loaded&#8217; error.</p>
<p>The Save file dialogue box is now only created as a RISC OS submenu if it is invoked by traversing the RISC OS menu structure using the arrow at the right of the Save menu option. If the Save file dialogue box is invoked by clicking on the Save menu option, from a command sequence (^FS), mapped keystroke (F3) or from the toolbar button, it is opened as a standalone dialogue box. This allows the user to then find a suitable directory viewer to drag the file icon to without the dialogue box collapsing. To cancel the dialogue box, press ESCAPE or click the Cancel button. Note that no other PipeDream dialogue boxes can be invoked whilst the Save dialogue box is being shown as a standalone dialogue box.</p>
<p>In addition to checking whether a file is being saved to a &#8216;safe&#8217; place, or is only having a partial range saved, saving a document to a file now also only renames the document in memory if it is being saved in its original format or in PipeDream format. This permits exporting documents to other formats using the Save file function without perturbing any external references.</p>
<p>Large file loading speeded up by optimising inner loops of load procedure for PipeDream files, together with an early check whether each cell contains text @-fields (most do not) allowing elimination of superfluous data copies.</p>
<p>Use larger buffer and improved buffered I/O code when reading and writing files (overall factor of 2+ speed improvement in both seen for large text files on a RISC PC).</p>
<p>Spreadsheet file loading speeded up by use of improved number reading code that performs earlier rejection of character sequences that won&#8217;t be recognised as numbers (e.g dates, slot / range references). It now also reads numbers as integers where that is possible. Both these cases used to spend too much time in floating point number decode.</p>
<p>File loading attempts to determine the line separator character(s) for use when saving non-PipeDream format documents. PipeDream format documents default to suggesting LF for save.</p>
<p>Shift-click on the PipeDream icon will open the Choices:PipeDream directory, in which you can find sub-directories containing the user-created Templates and CmdFiles (amongst others) that are used by PipeDream.</p>
<p>&#8216;Log labels&#8217; option in chart value axes dialogue boxes has been changed to &#8216;Power (10^n) labels&#8217;. When used with log scaling, this gives the same results as before, but now can be applied without selecting log scaling.</p>
<p>Filenames containing commas no longer cause the Documents and Charts sub-menus to foul up.</p>
<p>Documents and Charts sub-menus are now potentially double the width before entries are truncated and prefixed with ellipsis (for modern wider screens and fonty menus with thinner chars).</p>
<p>Help changed from PipeDream file to HTML help.</p>
<p>32-bit Lotus 1-2-3 converter utilities u_ltp (Lotus to PipeDream) and u_ptl (PipeDream to Lotus) are now supplied in PipeDream&#8217;s Resource directory.</p>
<p>Please note that there is no cute front end tool &#8211; you will need to invoke them in a (Ctrl-F12) Task window:</p>
<pre>PipeDream:u_ltp &lt;infile-lotus&gt; &lt;outfile-pipedream&gt;
PipeDream:u_ptl &lt;infile-pipedream&gt; &lt;outfile-lotus&gt;
</pre>
<p>Removed archaic floppy-disc outline logo from splash screen.</p>
<h4>4.50/42 (22 Mar 2013)</h4>
<p>Fixed bug where a reference to a document that failed to load could crash on use (could affect both spreadsheet and charts).</p>
<h4>4.50/41 (19 Mar 2013)</h4>
<p>Dependent document loading / naming code overhauled.</p>
<p>Allow code to run again on processors that don&#8217;t support UMULL (i.e. all pre-ARM600 CPUs) by dynamic patching of code for those systems. This was broken in 4.50/35 when PipeDream began using UMULL to speed 64-bit multiply operations.</p>
<p>Shift-click on the PipeDream icon will open the Choices: Templates directory.</p>
<p>Avoid chart creation exception when one series&#8217; data is all emptied.</p>
<p>Charts are created with a Draw font table that specifies just the fonts actually used by the chart, not all the fonts present in the system.</p>
<p>Chart line gallery code works again (it was broken in 4.50/36 where Cancel buttons added).</p>
<p>Lighter grid colour used by default.</p>
<p>Document title bar modified indicator is set/reset at correct point.</p>
<h4>4.50/40 (30 Oct 2012)</h4>
<p>Loading sheets with multiple levels of supporting documents now works as intended. For example, where Sheet_A depends on Sheet_B which depends on Sheet_C; and where Sheet_A also depends on Sheet_C. Sheet_B load could sometimes have failed or a spurious error could have been given after a successful load of all of the set of supporting documents.</p>
<h4>4.50/39 (26 Oct 2012)</h4>
<p>@C@ (colour change) behaviour is now consistent between printing and screen &#8211; the colour change is automatically cancelled at the end of a cell rather than at the end of the printout or end of the line.</p>
<p>PipeDream no longer incorrectly warns about saving to itself when Return is pressed in Save dialogue box with mouse pointer over the PipeDream window.</p>
<p>Fixed potential for evaluator crash (esp. custom functions) with zero-length strings that has existed since 4.50/08.</p>
<p>Evaluator long buffer size for named objects increased to match longer filename possibility.</p>
<p>Sliding window date handling would have failed in 2099!</p>
<p>Removed arbitrary 16-bit limit on evaluator array sizes.</p>
<p>Allow matrix inverse to be calculated for n &gt; 3.</p>
<p>BIN(), FLIP(), FORMULA_TEXT(), MEDIAN(), RANK(), SORT(), SPEARMAN(), TEXT() spreadsheet functions backported from Fireworkz (see functions added since 4.50/00).</p>
<p>CTERM() spreadsheet function can now take negative fv and pv arguments to calculate debt accrual (as in Fireworkz).</p>
<p>INT() spreadsheet function now performs rounding (at the 14th significant place) such that formulas which are affected by the imprecise floating point representation of fractional numbers e.g. INT((0.06-0.02)/2E-6) yield the correct integer value.</p>
<p>Ships with Master dictionary again (oops).</p>
<h4>4.50/38 (11 Oct 2012)</h4>
<p>Fixed possible crash when chart window is closed (introduced in /36).</p>
<p>Longer &#8216;Goto slot&#8217; field and amended validation string for possible external reference.</p>
<p>More code tidying.</p>
<p>ROOL RISC_OSLib now imported into separate pd/external directory.</p>
<p>Attempts support for Wimp$IconTheme for Sprites (RISC_OSLib convergence) although no new themed sprites are actually supplied.</p>
<h4>4.50/37 (19 Sep 2012)</h4>
<p>Add Choices:PipeDream. to the PipeDream$Path variable, replacing &lt;PipeDream$Dir&gt;.User. Please note that if you already have user dictionaries etc., you may wish to copy the contents of your existing<br />
&lt;PipeDream$Dir&gt;.User into &lt;Choices$Write&gt;.PipeDream:</p>
<pre>CDir &lt;Choices$Write&gt;.PipeDream
Copy &lt;PipeDream$Dir&gt;.User.* &lt;Choices$Write&gt;.PipeDream.* ~CRV
</pre>
<p>User directory in !PipeDream has now been renamed as Choices.PipeDream.</p>
<p>There is a TaskObey script file DoCopy in the Choices directory which will copy the contents of this directory to &lt;Choices$Write&gt;.PipeDream.</p>
<p>Newly created user dictionaries, templates etc. are now written to the appropriate location in &lt;Choices$Write&gt;.PipeDream so that each user&#8217;s choices may be placed outwith the !PipeDream directory. Subdirectories of &lt;Choices$Write&gt;.PipeDream will be created as needed by PipeDream.</p>
<p>Save choices option is greyed out if there isn&#8217;t a current document context to execute the command in.</p>
<p>Larger buffer for the PipeDream$Path variable to be expanded into for deep paths and/or very long PipeDream$UserPath path prefix dirs.</p>
<p>Now only checks that path element is a directory during each file load iff there&#8217;s a plausible match, eliminating redundant SWI calls.</p>
<p>Eliminated several redundant file open &amp; close operations during file load.</p>
<p>Simplify !Boot and !Run now we no longer cater for running from a pair of floppy disks.</p>
<p>Moved all Sprites, Templates and Messages files used by RISC_OSLib and other assorted run-time stuff from the !PipeDream.Resources directory into the new !PipeDream.Resource.RISC_OS directory to avoid any potential name clashes with user&#8217;s custom function sheets etc.</p>
<p>When closing a document window, no longer bring another document to the front and set the caret into it. This avoids unwanted unpinning of documents from the Pinboard.</p>
<p>Sequences of consequent dialogue boxes (when closing PipeDream with a number of modified documents) now remember the dialogue box position for the subsequent dialogue box to be opened at, preventing the progressive crawl of dialogue boxes towards the bottom right of the screen.</p>
<p>Dialogue boxes opened as a result of a keyboard shortcut now appear near the caret (in fact a short distance right and down), as originally intended. This had in fact been broken since the early days of PipeDream 3!</p>
<p>Larger dialogue box margins to better accommodate 3-D internal window borders and more modern, less cramped, style.</p>
<p>Writeable icons use RISC OS Style Guide compliant appearance and size.</p>
<p>No longer force use of PipeDream&#8217;s own radio, check and up/down buttons.</p>
<p>Large chart gallery and colour options dialogue boxes that are expandable using the toggle icon now also have vertical scroll bars for operational clarity.</p>
<p>Fixed !Help for font selector dialogue box.</p>
<p>No longer bother to squash Messages and Sprite files.</p>
<p>Code to handle running on systems prior to RISC OS 3.1 removed for clarity.</p>
<p>More work to clean up source for open-source release.</p>
<p>Dropped optimised support for loading files directly from Z88 filing system for clarity in source. It&#8217;s much better for them to be copied off the Z88 first and then loaded into PipeDream.</p>
<p>Now works with Avisoft Reporter (when built with selected instrumentation).</p>
<h4>4.50/36 (31 Aug 2012)</h4>
<p>Eliminated a couple of MOVS pc, lr that fouled up on ARMv7 systems. Note that there will always be a couple of 26-bit only instructions present in the executable code as PipeDream&#8217;s Escape and Event handlers are called in 26-bit or 32-bit mode on different systems (e.g. RISC OS 4.39&#8217;s 26-bit kernel and RISC OS 5.20&#8217;s 32-bit kernel) with the appropriate code being executed conditionally.</p>
<p>Low-level memory allocator changed to pre-RISC OS 5.18 compatible allocator (from Fireworkz) that doesn&#8217;t use OS_Heap SWIs to isolate from RISC OS 5.18 OS_Heap SWI changes. It&#8217;s also faster due to no SWI overheads.</p>
<p>The character used in text @-fields may now be set to other than &#8216;@&#8217; in a document&#8217;s Options dialogue box. Important notes: this does not change any existing text. When changing this character, all cells containing slot reference text @-fields will need to be &#8216;recompiled&#8217; to reflect this &#8211; the easiest (and safest) way of doing this is to save the document and reload it immediately after closing the Options dialogue box. Other text @-fields will update immediately.</p>
<p>Dialogue boxes that have a Cancel button or are definitely always raised as menus or submenus (e.g. About this program) no longer have a close icon (and thereby possibly unwanted iconise icon) on the title bar. This was a hangover from having always had to use a very, very old template editor prior to using !WinEd.</p>
<p>Chart bar / line / pie / scatter galleries spruced up with higher res sprites.</p>
<p>Can now directly import JPEG files.</p>
<p>New mode sprite bounding box correctly calculated using its dpi.</p>
<p>DragASprite in Save dialogue box now respects configuration set by !Boot.</p>
<p>Use ColourPicker module to select chart colours rather than old dboxtcol.</p>
<p>Uses 24-bit palette entries rather than copying nibbles a la RO2.</p>
<p>Eliminate redundant Draw groups in chart text objects.</p>
<p>Removed archaic Drawfile loading and rendering code from RISC_OSLib (saves about 34KB; only renders using Drawfile module).</p>
<p>Begin merge of PipeDream&#8217;s copy of RISC_OSLib with modern one from ROOL.</p>
<p>Allow matrix determinant to be calculated for larger sizes.</p>
<h4>4.50/35 (23 Mar 2012)</h4>
<p>Fully 32-bit-ised the muldiv64 assember code module for ARMv7.</p>
<p>Updated ImageSlot to 32-bit compatible version (same as used by Fireworkz)</p>
<p>No longer require the very latest FPEmulator in !Run.</p>
<h4>4.50/34 (22 Mar 2012)</h4>
<p>Fixed spreadsheet array formula processing code that could crash PipeDream (the new C compiler no longer concealed this bug!).</p>
<p>Fixed call to Wimp_SlotSize to save critcal regs around call (was corrupt).</p>
<p>Allow &#8211;no-dynamic-areas option to be set in PipeDream$$RunOptions to avoid fragmenting address space on large memory systems (this is automatically done in !Run for RISC OS 5).</p>
<p>Check for CallASWI module in !Run for new SharedCLibrary (CallASWI needs loading on RISC OS 3.6 and below).</p>
<h4>4.50/33 (22 Mar 2012)</h4>
<p>Evaluator compiled without -Otime optimisation &#8211; crashed some stats sheets.</p>
<h4>4.50/32 (21 Mar 2012)</h4>
<p>Really! Has it been that long?</p>
<p>First 32-bit release of PipeDream, built using RISC OS Open Limited C tools release 20.</p>
<p>Registration number code and template info removed as the PipeDream installer no longer generates one. Previous Info files may be used to show user and organisation name in the splash screen and Info box.</p>
<h4>4.50/23 (10 Aug 2000)</h4>
<p>PipeDream documents can now be saved with leafnames longer than 12 characters where this is allowed, e.g. RISC OS 4 new format hard discs, ADFS E+/F+ format floppies and RAM discs. This may also work on earlier systems with the Longnames module loaded or into archive files, but this has<br />
not been tested.</p>
<p>PipeDream tested against RISC OS 4.02 (patch 3 release 2)</p>
<h4>4.50/22 (11 Apr 1999)</h4>
<p>Range over which COMBIN() and PERMUT() spreadsheet functions work increased, avoiding integer overflow.</p>
<h4>4.50/21 (17 Jan 1999)</h4>
<p>^LAW (auto width) now works correctly again using marked blocks. This had been broken since 4.50/08.</p>
<p>E format numbers in chart axes no longer contain superfluous commas.</p>
<p>@C:r,g,b@ can be used to set the colour of the following text on a line (only when using fonts and RISC OS 3.5 or later) e.g. aaa@C:240,0,0@bbb would display aaa followed by bbb in red. Use @C@ to restore normal (black).</p>
<p>Versions prior to this one will display the full @ sequence instead of the colour change.</p>
<p>Caters for loading Squashed Messages, Sprites, Sprites22.</p>
<p>Superfluous !Help file removed from Resources directory; PipeDream always uses the one from the main !PipeDream directory, as does the RISC OS Filer.</p>
<p>First full (i.e. non-upgrade) version of PipeDream 4.5 released.</p>
<h4>4.50/20 (14 Nov 1998)</h4>
<p>Bug whereby 31.12.2000 displayed as 01.01.2001 fixed.</p>
<p>Save file as paragraph type no longer forces paragraph separator to LF.</p>
<p>Tristate icons (don&#8217;t care / yes / no choice) now work correctly.</p>
<h4>4.50/14 (12 Jan 1998)</h4>
<p>Dialogue boxes dynamically modified on RISC OS 3.1 to use menu-type icons no longer force an explicit ESG (used to set ESG 15) to avoid unsetting radio buttons in the dialogue box. The templates have been modified to accommodate this.</p>
<h4>4.50/13 (13 Nov 1997)</h4>
<p>Thin grid lines are now printed again using a default line width of zero.</p>
<p>In order to get round various printer driver faults you may need to add an extra argument into the last line of !PipeDream.!Run so that it reads:</p>
<p>Run &lt;PipeDream$$ImageDir&gt;.Resource.Image -k 64 %*0</p>
<p>where the number after -k is the desired line thickness in Draw units (there are 256 of these per OS unit), 64 being the value previously hard-coded in v4.50/10 &#8211; v4.50/12. You may need to make this number larger or smaller depending on the particular printer driver you use.</p>
<h4>4.50/12 (10 Nov 1997)</h4>
<p>Entering a date with a two digit year is how handled using a sliding window about the present year such that it yields a year in the range now-70 &lt; year &lt;= now+30. This also applies to the DATE() and DATEVALUE() spreadsheet functions.</p>
<p>Dialogue boxes now dynamically modified on RISC OS 3.1 to use menu-type icons with R1 effect rather than standard R6,3 action buttons in order to work around the RISC OS 3.1 Window Manager problem where the Window Manager would try to redraw an icon in a dialogue box that no longer exists.</p>
<h4>4.50/11 (08 Sep 1997)</h4>
<p>Sassoon.Primary now changes to Sassoon.Bold when bold highlight is used.</p>
<p>Delete Row In Column now sets file modified.</p>
<p>PROPER(&#8220;o&#8217;connor&#8221;) spreadsheet function now correctly returns &#8220;O&#8217;Connor&#8221;.</p>
<p>PROPER(&#8220;barnes-wallis&#8221;) spreadsheet function now correctly returns &#8220;Barnes-Wallis&#8221;.</p>
<p>VALUE() spreadsheet function fixed to return 0 when presented with input that doesn&#8217;t yield a numeric result.</p>
<h4>4.50/10 (28 May 1997)</h4>
<p>PipeDream now claims an extra 4KB of stack memory whilst starting up in order to prevent itself running out of memory whilst starting to print when this is invoked from the button bar.</p>
<p>You can now raise negative numbers to odd fractional powers e.g. (-8)^(1/3) will find the cube root of two &#8211; in fact the cube root with zero imaginary part.</p>
<p>Thin grid lines are now printed using a very small (but non-zero) line width in order to get round some printer driver faults.</p>
<h4>4.50/09 (27 Jan 1997)</h4>
<p>PipeDream now claims an extra 32KB of memory before starting to print in order to prevent itself running out of memory whilst printing.</p>
<h4>4.50/08 (17 Jan 1997)</h4>
<p>Ctrl-TAB and Shift-Ctrl-TAB when text is in the editing line didn&#8217;t enter the text into the edited slot before moving.</p>
<p>Manual axis settings now override any automatically calculated limits. Data values beyond the min/max axis values are now clipped at the min/max axis values.</p>
<p>Cumulative bar/line charts now add in negative values rather than ignoring them.</p>
<p>^BRP now enters the Search &amp; Replace dialogue box with the replace option already checked.</p>
<p>Borders removed from icons in Chart-&gt;Selection-&gt;Series dialogue box.</p>
<p>Chart-&gt;Selection-&gt;Fill style dialogue box now displays file name correctly.</p>
<p>MONTHNAME() spreadsheet function corrected (was one month out).</p>
<p>row number alignment now behaves the same on all systems.</p>
<h4>4.50/07 (08 Jan 1997)</h4>
<p>Colour inversion handling in &gt; 256 colour modes should now be right: it used to sometimes leave &#8216;droppings&#8217; of previously marked areas temporarily greyed out on the document.</p>
<p>Spell check word inversion should now work in &gt; 256 colour modes.</p>
<p>No longer keeps bringing dialogue boxes to the front so that BubbleHelp throbs less when pointing at a PipeDream dialogue box.</p>
<p>Recalc number (and column width indicator) now lines up properly.</p>
<p>The document window with the input focus now changes properly to the input focus colour.</p>
<h4>4.50/06 (01 Dec 1996)</h4>
<p>WEEKNUMBER() spreadsheet function added.</p>
<p>@D@ now outputs century prefix in English/American format as well as Text.</p>
<p>@F:x{,y}@ now accepted as way of performing font size change without changing font too.</p>
<p>Call to Font_ScanString fixed so super/subscripts display correctly.</p>
<p>Residual debugging information removed from release version.</p>
<h4>4.50/05 (27 Nov 1996)</h4>
<p>Handles PD4.5(old) -&gt; PD4.5(new) upgrade.</p>
<p>Handles PD3 upgrade much smoother.</p>
<p>Problem whereby sheet data and protection state was corrupted when sorting the contents of a file with Dynamic area handling in use fixed.</p>
<p>Sliders in colour selector dialogue boxes now display correctly.</p>
<p>Word count now displays correctly.</p>
<p>Text/English/American date display option fixed.</p>
<p>Justify button now correctly updates internal state.</p>
<p>Factorials more accurately calculated for larger n.</p>
<p>Formula window selections now invert correctly in &gt;= 256 colour modes.</p>
<p>(NB This release history only goes back to 1996)</p>
</body>
</html>